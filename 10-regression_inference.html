<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Detailed Course Notes for ECON 4750 - 11&nbsp; Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-binary_outcomes.html" rel="next">
<link href="./09-regression_computation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="4750_style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-regression_inference.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inference</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Detailed Course Notes for ECON 4750</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Start</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Statistical Programming</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction_to_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-programming_in_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programming in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Probability</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-random_variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-expectations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Expectation, Variance, and More</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Properties of Estimators</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-finite_sample_properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Finite Sample Properties</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-asymptotic_properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asymptotic Properties</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Regression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-interpreting_regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Interpreting Regressions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-regression_computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Computation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression_inference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Advanced Topics</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-binary_outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Binary Outcome Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Prediction</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-model_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Causal Inference</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-causal_inference_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-natural_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Natural Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-observational_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Causal Inference with Observational Data</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#inference" id="toc-inference" class="nav-link active" data-scroll-target="#inference"><span class="header-section-number">11.1</span> Inference</a>
  <ul class="collapse">
  <li><a href="#computation" id="toc-computation" class="nav-link" data-scroll-target="#computation"><span class="header-section-number">11.1.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#lab-4-birthweight-and-smoking" id="toc-lab-4-birthweight-and-smoking" class="nav-link" data-scroll-target="#lab-4-birthweight-and-smoking"><span class="header-section-number">11.2</span> Lab 4: Birthweight and Smoking</a></li>
  <li><a href="#lab-4-solutions" id="toc-lab-4-solutions" class="nav-link" data-scroll-target="#lab-4-solutions"><span class="header-section-number">11.3</span> Lab 4: Solutions</a></li>
  <li><a href="#coding-questions" id="toc-coding-questions" class="nav-link" data-scroll-target="#coding-questions"><span class="header-section-number">11.4</span> Coding Questions</a></li>
  <li><a href="#extra-questions" id="toc-extra-questions" class="nav-link" data-scroll-target="#extra-questions"><span class="header-section-number">11.5</span> Extra Questions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inference</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><span class="math display">\[
\newcommand{\E}{\mathbb{E}}
\renewcommand{\P}{\textrm{P}}
\let\L\relax
\newcommand{\L}{\textrm{L}} %doesn't work in .qmd, place this command at start of qmd file to use it
\newcommand{\F}{\textrm{F}}
\newcommand{\var}{\textrm{var}}
\newcommand{\cov}{\textrm{cov}}
\newcommand{\corr}{\textrm{corr}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Corr}{\mathrm{Corr}}
\newcommand{\sd}{\mathrm{sd}}
\newcommand{\se}{\mathrm{s.e.}}
\newcommand{\T}{T}
\newcommand{\indicator}[1]{\mathbb{1}\{#1\}}
\newcommand\independent{\perp \!\!\! \perp}
\newcommand{\N}{\mathcal{N}}
\]</span></p>
<section id="inference" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="inference"><span class="header-section-number">11.1</span> Inference</h2>
<p>SW 4.5, 5.1, 5.2, 6.6</p>
<p>We discussed in class the practical issues of inference in linear regression models.</p>
<p>These results rely on arguments building on the Central Limit Theorem (this should not surprise you as it is similar to the case for the asymptotic distribution of <span class="math inline">\(\sqrt{n}(\bar{Y} - \E[Y]))\)</span> that we discussed earlier in the semester.</p>
<p>In this section, I sketch these types of arguments for you. This material is advanced, but I suggest that you study this material.</p>
<p>We are going to show that, in the simple linear regression model, <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) \rightarrow N(0,V) \quad \textrm{as} \ n \rightarrow \infty
\end{align*}\]</span> where <span class="math display">\[\begin{align*}
  V = \frac{\E[(X-\E[X])^2 U^2]}{\var(X)^2}
\end{align*}\]</span> and discuss how to use this result to conduct inference.</p>
<p>Let’s start by showing why this result holds.</p>
<p>To start with, recall that <span id="eq-b1"><span class="math display">\[
\hat{\beta}_1 = \frac{\widehat{\cov}(X,Y)}{\widehat{\var}(X)}
\tag{11.1}\]</span></span></p>
<p>Before providing a main result, let’s start with noting the following:</p>
<p><em>Helpful Intermediate Result 1</em> Notice that <span class="math display">\[\begin{align*}
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})\bar{Y}\Big) &amp;= \bar{Y} \frac{1}{n}\sum_{i=1}^n \Big( X_i-\bar{X} \Big) \\
  &amp;= \bar{Y} \left( \frac{1}{n}\sum_{i=1}^n X_i - \frac{1}{n}\sum_{i=1}^n \bar{X} \right) \\
  &amp;= \bar{Y} \Big(\bar{X} - \bar{X} \Big) \\
  &amp;= 0
\end{align*}\]</span> where the first equality just pulls <span class="math inline">\(\bar{Y}\)</span> out of the summation (it is a constant with respect to the summation), the second equality pushes the summation through the difference, the first part of the third equality holds by the definition of <span class="math inline">\(\bar{X}\)</span> and the second part holds because it is an average of a constant.</p>
<p>This implies that <span id="eq-hr1"><span class="math display">\[
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})(Y_i - \bar{Y})\Big) = \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})Y_i\Big)
\tag{11.2}\]</span></span> and very similar arguments (basically the same arguments in reverse) also imply that <span id="eq-hr2"><span class="math display">\[
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})X_i\Big) = \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})(X_i - \bar{X})\Big)
\tag{11.3}\]</span></span> We use both <a href="#eq-hr1" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-hr1</span></a> and <a href="#eq-hr2" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-hr2</span></a> below.</p>
<p>Next, consider the numerator in <a href="#eq-b1" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-b1</span></a> <span class="math display">\[\begin{align*}
  \widehat{\cov}(X,Y) &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y}) \\
  &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})Y_i \\
  &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(\beta_0 + \beta_1 X_i + U_i) \\
  &amp;= \underbrace{\beta_0 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})}_{(A)} + \underbrace{\beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) X_i}_{(B)} + \underbrace{\frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) U_i}_{(C)}) \\
\end{align*}\]</span> where the first equality holds by the definition of sample covariance, the second equality holds by <a href="#eq-hr1" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-hr1</span></a>, the third equality plugs in for <span class="math inline">\(Y_i\)</span>, and the last equality combines terms and passes the summation through the additions/subtractions.</p>
<p>Now, let’s consider each of these in turn.</p>
<p>For (A), <span class="math display">\[\begin{align*}
  \frac{1}{n} \sum_{i=1}^n X_i = \bar{X} \qquad \textrm{and} \qquad \frac{1}{n} \sum_{i=1}^n \bar{X} = \bar{X}
\end{align*}\]</span> which implies that this term is equal to 0.</p>
<p>For (B), notice that <span class="math display">\[\begin{align*}
  \beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) X_i &amp;= \beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) (X_i - \bar{X}) \\
  &amp;= \beta_1 \widehat{\var}(X)
\end{align*}\]</span> where the first equality holds by <a href="#eq-hr2" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-hr2</span></a> and the second equality holds by the definition of sample variance.</p>
<p>For (C), well, we’ll just carry that one around for now.</p>
<p>Plugging in the expressions for (A), (B), and (C) back into Equation <a href="#eq-b1" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-b1</span></a> implies that <span class="math display">\[\begin{align*}
  \hat{\beta}_1 = \beta_1 + \frac{1}{n} \sum_{i=1}^n \frac{(X_i - \bar{X}) U_i}{\widehat{\var}(X)}
\end{align*}\]</span> Next, re-arranging terms and multiplying both sides by <span class="math inline">\(\sqrt{n}\)</span> implies that <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) &amp;= \sqrt{n} \left(\frac{1}{n} \sum_{i=1}^n \frac{(X_i - \bar{X}) U_i}{\widehat{\var}(X)}\right) \\
  &amp; \approx \sqrt{n} \left(\frac{1}{n} \sum_{i=1}^n \frac{(X_i - \E[X]) U_i}{\var(X)}\right)
\end{align*}\]</span> The last line (the approximately one) is kind of a weak argument, but basically you can replace <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\widehat{\var}(X)\)</span> and the effect of this replacement will converge to 0 in large samples (this is the reason for the approximately) — if you want a more complete explanation, sign up for my graduate econometrics class next semester.</p>
<p>Is this helpful? It may not be obvious, but the right hand side of the above equation is actually something that we can apply the Central Limit Theorem to. In particular, maybe it is helpful to define <span class="math inline">\(Z_i = \frac{(X_i - \E[X]) U_i}{\var(X)}\)</span>. We know that we could apply a Central Limit Theorem to <span class="math inline">\(\sqrt{n}\left( \frac{1}{n} \sum_{i=1}^n Z_i \right)\)</span> if (i) <span class="math inline">\(Z_i\)</span> had mean 0, and (ii) it is iid. That it is iid holds immediately from the random sampling assumption. For mean 0, <span class="math display">\[\begin{align*}
  \E[Z] &amp;= \E\left[ \frac{(X - \E[X]) U}{\var(X)}\right] \\
  &amp;= \frac{1}{\var(X)} \E[(X - \E[X]) U] \\
  &amp;= \frac{1}{\var(X)} \E[(X - \E[X]) \underbrace{\E[U|X]}_{=0}] \\
  &amp;= 0
\end{align*}\]</span> where the only challenging line here is the third one holds from the Law of Iterated Expectations. This means that we can apply the central limit theorem, and in particular, <span class="math inline">\(\sqrt{n} \left( \frac{1}{n} \sum_{i=1}^n Z_i \right) \rightarrow N(0,V)\)</span> where <span class="math inline">\(V=\var(Z) = \E[Z^2]\)</span> (where the 2nd equality here holds because <span class="math inline">\(Z\)</span> has mean 0). Now, just substituting back in for <span class="math inline">\(Z\)</span> implies that <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) \rightarrow N(0,V)
\end{align*}\]</span> where <span id="eq-V"><span class="math display">\[
\begin{aligned}
  V &amp;= \E\left[ \left( \frac{(X - \E[X]) U}{\var(X)} \right)^2 \right] \nonumber \\
  &amp;= \E\left[ \frac{(X - \E[X])^2 U^2}{\var(X)^2}\right]
\end{aligned}
\tag{11.4}\]</span></span> which is what we were aiming for.</p>
<p>Given this result, all our previous work on standard errors, t-statistics, p-values, and confidence intervals applies. First, let me mention the way that you would estimate <span class="math inline">\(V\)</span> (same as always, just replace the population quantities with corresponding sample quantities).</p>
<p><span class="math display">\[
  \hat{V} = \frac{ \displaystyle \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})^2 \hat{U}_i^2}{\widehat{\Var}(X)^2}
\]</span></p>
<p>where <span class="math inline">\(\hat{U}_i\)</span> are the residuals.</p>
<p>Now, standard errors are just the same as before (the only difference is that <span class="math inline">\(\hat{V}\)</span> itself has changed)</p>
<p><span class="math display">\[
\begin{aligned}
  \textrm{s.e.}(\hat{\beta}) &amp;= \frac{\sqrt{\hat{V}}}{\sqrt{n}}
\end{aligned}
\]</span></p>
<p>By far the most common null hypothesis is <span class="math inline">\(H_0: \beta = 0\)</span>, which suggests the following t-statistic:</p>
<p><span class="math display">\[
  t = \frac{\hat{\beta}}{\textrm{s.e.}(\hat{\beta})}
\]</span> One can continue to calculate a p-value by</p>
<p><span class="math display">\[
  \textrm{p-value} = 2 \Phi(-|t|)
\]</span> and a 95% confidence interval is given by</p>
<p><span class="math display">\[
  CI = [\hat{\beta} - 1.96 \textrm{s.e.}(\hat{\beta}), \hat{\beta} + 1.96 \textrm{s.e.}(\hat{\beta})]
\]</span></p>
<section id="computation" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="computation"><span class="header-section-number">11.1.1</span> Computation</h3>
<p>Let’s check if what we derived is what we can compute using <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the same regression as in the previous section</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7121 -2.1122 -0.8854  1.5819  8.2360 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
hp          -0.06823    0.01012  -6.742 1.79e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.863 on 30 degrees of freedom
Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892 
F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show previous calcuations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">bet0=</span>bet0, <span class="at">bet1=</span>bet1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bet0        bet1
1 30.09886 -0.06822828</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># components of Vhat</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>hp</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Uhat <span class="ot">&lt;-</span> Y <span class="sc">-</span> bet0 <span class="sc">-</span> bet1<span class="sc">*</span>X</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>varX <span class="ot">&lt;-</span> <span class="fu">mean</span>( (X<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Vhat <span class="ot">&lt;-</span> <span class="fu">mean</span>( (X<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> Uhat<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">/</span> ( varX<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mtcars)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Vhat)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> bet1<span class="sc">/</span>se</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(t_stat))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ci_L <span class="ot">&lt;-</span> bet1 <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>ci_U <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(se, t_stat, p_val, ci_L, ci_U),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       se   t_stat p_val     ci_L     ci_U
1 0.01313 -5.19644     0 -0.09396 -0.04249</code></pre>
</div>
</div>
<p>Interestingly, these are not <em>exactly</em> the same as what comes from the <code>lm</code> command. Here’s what the difference is: <code>R</code> makes a simplifying assumption called “homoskedasticity” that simplifies the expression for the variance. This can result in slightly different standard errors (and therefore slightly different t-statistics, p-values, and confidence intervals too) than the ones we calculated.</p>
<p>An alternative package that is popular among economists for estimating regressions and getting “heteroskedasticity robust” standard errors is the <code>estimatr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>reg9 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(mpg <span class="sc">~</span> hp, <span class="at">data=</span>mtcars, <span class="at">se_type=</span><span class="st">"HC0"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm_robust(formula = mpg ~ hp, data = mtcars, se_type = "HC0")

Standard error type:  HC0 

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
(Intercept) 30.09886    2.01067  14.970 1.851e-15 25.99252 34.20520 30
hp          -0.06823    0.01313  -5.196 1.338e-05 -0.09504 -0.04141 30

Multiple R-squared:  0.6024 ,   Adjusted R-squared:  0.5892 
F-statistic:    27 on 1 and 30 DF,  p-value: 1.338e-05</code></pre>
</div>
</div>
<p>The “HC0” standard errors are “heteroskedasticity consistent” standard errors, and you can see that they match what we calculated above.</p>
</section>
</section>
<section id="lab-4-birthweight-and-smoking" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="lab-4-birthweight-and-smoking"><span class="header-section-number">11.2</span> Lab 4: Birthweight and Smoking</h2>
<p>For this lab, we’ll use the data <code>Birthweight_Smoking</code> and study the relationship between infant birthweight and mother’s smoking behavior.</p>
<ol type="1">
<li><p>Run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>. How do you interpret the results?</p></li>
<li><p>Use the <code>datasummary_balance</code> function from the <code>modelsummary</code> package to provide summary statistics for each variable in the data separately by smoking status of the mother. Do you notice any interesting patterns?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, <span class="math inline">\(educ\)</span>, <span class="math inline">\(nprevisit\)</span>, <span class="math inline">\(age\)</span>, and <span class="math inline">\(alcohol\)</span>. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span>? How does its magnitude compare to the result from #1? What do you make of this?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, the interaction of <span class="math inline">\(smoker\)</span> and <span class="math inline">\(age\)</span> and the other covariates (including <span class="math inline">\(age\)</span>) from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span> and the coefficient on the interaction term?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, the interaction of <span class="math inline">\(smoker\)</span> and <span class="math inline">\(alcohol\)</span> and the other covariates from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span> and the coefficient on the interaction term?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(age\)</span> and <span class="math inline">\(age^2\)</span>. Plot the predicted value of birthweight as a function of age for ages from 18 to 44. What do you make of this?</p></li>
<li><p>Now run a regression of <span class="math inline">\(\log(birthweight)\)</span> on <span class="math inline">\(smoker\)</span> and the other covariates from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span>?</p></li>
</ol>
</section>
<section id="lab-4-solutions" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="lab-4-solutions"><span class="header-section-number">11.3</span> Lab 4: Solutions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Birthweight_Smoking <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data/birthweight_smoking.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker, <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-3007.06  -313.06    26.94   366.94  2322.94 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3432.06      11.87 289.115   &lt;2e-16 ***
smoker       -253.23      26.95  -9.396   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 583.7 on 2998 degrees of freedom
Multiple R-squared:  0.0286,    Adjusted R-squared:  0.02828 
F-statistic: 88.28 on 1 and 2998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We estimate that, on average, smoking reduces an infant’s birthweight by about 250 grams. The estimated effect is strongly statistically significant, and (I am not an expert but) that seems like a large effect of smoking to me.</p>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create smoker factor --- just to make table look nicer</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Birthweight_Smoking<span class="sc">$</span>smoker_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(Birthweight_Smoking<span class="sc">$</span>smoker<span class="sc">==</span><span class="dv">1</span>, <span class="st">"smoker"</span>, <span class="st">"non-smoker"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_balance</span>(<span class="sc">~</span>smoker_factor, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>dplyr<span class="sc">::</span><span class="fu">select</span>(Birthweight_Smoking, <span class="sc">-</span>smoker),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fmt=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script src="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js"></script>

    <script>
      // Create table-specific functions using external factory
      const tableFns_k8ynq2qzn01ckwrsh6z2 = TinyTable.createTableFunctions("tinytable_k8ynq2qzn01ckwrsh6z2");
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '8', j: 2 }, { i: '9', j: 2 }, { i: '10', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '7', j: 3 }, { i: '8', j: 3 }, { i: '9', j: 3 }, { i: '10', j: 3 }, { i: '1', j: 4 }, { i: '2', j: 4 }, { i: '3', j: 4 }, { i: '4', j: 4 }, { i: '5', j: 4 }, { i: '6', j: 4 }, { i: '7', j: 4 }, { i: '8', j: 4 }, { i: '9', j: 4 }, { i: '10', j: 4 }, { i: '1', j: 5 }, { i: '2', j: 5 }, { i: '3', j: 5 }, { i: '4', j: 5 }, { i: '5', j: 5 }, { i: '6', j: 5 }, { i: '7', j: 5 }, { i: '8', j: 5 }, { i: '9', j: 5 }, { i: '10', j: 5 }, { i: '1', j: 6 }, { i: '2', j: 6 }, { i: '3', j: 6 }, { i: '4', j: 6 }, { i: '5', j: 6 }, { i: '6', j: 6 }, { i: '7', j: 6 }, { i: '8', j: 6 }, { i: '9', j: 6 }, { i: '10', j: 6 }, { i: '1', j: 7 }, { i: '2', j: 7 }, { i: '3', j: 7 }, { i: '4', j: 7 }, { i: '5', j: 7 }, { i: '6', j: 7 }, { i: '7', j: 7 }, { i: '8', j: 7 }, { i: '9', j: 7 }, { i: '10', j: 7 } ], css_id: 'tinytable_css_6sgsbasfydgny317vzv0',}, 
          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '7', j: 1 }, { i: '8', j: 1 }, { i: '9', j: 1 }, { i: '10', j: 1 } ], css_id: 'tinytable_css_izar7185jqwjl7vhb1la',}, 
          { positions: [ { i: '11', j: 2 }, { i: '11', j: 3 }, { i: '11', j: 4 }, { i: '11', j: 5 }, { i: '11', j: 6 }, { i: '11', j: 7 } ], css_id: 'tinytable_css_y17n0uq7cdf7vmvdatdo',}, 
          { positions: [ { i: '11', j: 1 } ], css_id: 'tinytable_css_xqtu0wbw2cjsbhgdxq4v',}, 
          { positions: [ { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 } ], css_id: 'tinytable_css_t4bvqxbinm24pyfz8w0t',}, 
          { positions: [ { i: '0', j: 1 } ], css_id: 'tinytable_css_7n8v3hp143x1hi1bhp1d',}, 
          { positions: [ { i: '-1', j: 3 }, { i: '-1', j: 5 } ], css_id: 'tinytable_css_w4rrhbam9ze0hft6bwtm',}, 
          { positions: [ { i: '-1', j: 2 }, { i: '-1', j: 4 } ], css_id: 'tinytable_css_bu15yqi8zua5y21ufy6x',}, 
          { positions: [ { i: '-1', j: 1 }, { i: '-1', j: 6 }, { i: '-1', j: 7 } ], css_id: 'tinytable_css_t3te0n498sd4jmrdzcvb',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  tableFns_k8ynq2qzn01ckwrsh6z2.styleCell(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css">
    <style>
    /* tinytable css entries after */
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_6sgsbasfydgny317vzv0, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_6sgsbasfydgny317vzv0 { text-align: right }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_izar7185jqwjl7vhb1la, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_izar7185jqwjl7vhb1la { text-align: left }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_y17n0uq7cdf7vmvdatdo, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_y17n0uq7cdf7vmvdatdo {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: right }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_xqtu0wbw2cjsbhgdxq4v, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_xqtu0wbw2cjsbhgdxq4v {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_t4bvqxbinm24pyfz8w0t, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_t4bvqxbinm24pyfz8w0t {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: right }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_7n8v3hp143x1hi1bhp1d, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_7n8v3hp143x1hi1bhp1d {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_w4rrhbam9ze0hft6bwtm, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_w4rrhbam9ze0hft6bwtm {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 3%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_bu15yqi8zua5y21ufy6x, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_bu15yqi8zua5y21ufy6x {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 3%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }
    #tinytable_k8ynq2qzn01ckwrsh6z2 td.tinytable_css_t3te0n498sd4jmrdzcvb, #tinytable_k8ynq2qzn01ckwrsh6z2 th.tinytable_css_t3te0n498sd4jmrdzcvb {  position: relative; --border-bottom: 0; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }
    </style>
    <div class="container">
      <table class="tinytable" id="tinytable_k8ynq2qzn01ckwrsh6z2" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        
        <thead>
<tr>
<th scope="col" align="center" colspan="1" data-row="-1" data-col="1"> </th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="2">non-smoker (N=2418)</th>
<th scope="col" align="center" colspan="2" data-row="-1" data-col="4">smoker (N=582)</th>
<th scope="col" align="center" colspan="1" data-row="-1" data-col="6"> </th>
<th scope="col" align="center" colspan="1" data-row="-1" data-col="7"> </th>
</tr>
              <tr>
                <th scope="col" data-row="0" data-col="1"> </th>
                <th scope="col" data-row="0" data-col="2">Mean</th>
                <th scope="col" data-row="0" data-col="3">Std. Dev.</th>
                <th scope="col" data-row="0" data-col="4">Mean</th>
                <th scope="col" data-row="0" data-col="5">Std. Dev.</th>
                <th scope="col" data-row="0" data-col="6">Diff. in Means</th>
                <th scope="col" data-row="0" data-col="7">Std. Error</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="1">nprevist</td>
                  <td data-row="1" data-col="2">11.19</td>
                  <td data-row="1" data-col="3">3.50</td>
                  <td data-row="1" data-col="4">10.18</td>
                  <td data-row="1" data-col="5">4.23</td>
                  <td data-row="1" data-col="6">-1.01</td>
                  <td data-row="1" data-col="7">0.19</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="1">alcohol</td>
                  <td data-row="2" data-col="2">0.01</td>
                  <td data-row="2" data-col="3">0.11</td>
                  <td data-row="2" data-col="4">0.05</td>
                  <td data-row="2" data-col="5">0.22</td>
                  <td data-row="2" data-col="6">0.04</td>
                  <td data-row="2" data-col="7">0.01</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="1">tripre1</td>
                  <td data-row="3" data-col="2">0.83</td>
                  <td data-row="3" data-col="3">0.38</td>
                  <td data-row="3" data-col="4">0.70</td>
                  <td data-row="3" data-col="5">0.46</td>
                  <td data-row="3" data-col="6">-0.13</td>
                  <td data-row="3" data-col="7">0.02</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="1">tripre2</td>
                  <td data-row="4" data-col="2">0.14</td>
                  <td data-row="4" data-col="3">0.34</td>
                  <td data-row="4" data-col="4">0.22</td>
                  <td data-row="4" data-col="5">0.41</td>
                  <td data-row="4" data-col="6">0.08</td>
                  <td data-row="4" data-col="7">0.02</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="1">tripre3</td>
                  <td data-row="5" data-col="2">0.03</td>
                  <td data-row="5" data-col="3">0.16</td>
                  <td data-row="5" data-col="4">0.06</td>
                  <td data-row="5" data-col="5">0.24</td>
                  <td data-row="5" data-col="6">0.04</td>
                  <td data-row="5" data-col="7">0.01</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="1">tripre0</td>
                  <td data-row="6" data-col="2">0.01</td>
                  <td data-row="6" data-col="3">0.08</td>
                  <td data-row="6" data-col="4">0.02</td>
                  <td data-row="6" data-col="5">0.15</td>
                  <td data-row="6" data-col="6">0.02</td>
                  <td data-row="6" data-col="7">0.01</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="1">birthweight</td>
                  <td data-row="7" data-col="2">3432.06</td>
                  <td data-row="7" data-col="3">584.62</td>
                  <td data-row="7" data-col="4">3178.83</td>
                  <td data-row="7" data-col="5">580.01</td>
                  <td data-row="7" data-col="6">-253.23</td>
                  <td data-row="7" data-col="7">26.82</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="1">unmarried</td>
                  <td data-row="8" data-col="2">0.18</td>
                  <td data-row="8" data-col="3">0.38</td>
                  <td data-row="8" data-col="4">0.43</td>
                  <td data-row="8" data-col="5">0.50</td>
                  <td data-row="8" data-col="6">0.25</td>
                  <td data-row="8" data-col="7">0.02</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="1">educ</td>
                  <td data-row="9" data-col="2">13.15</td>
                  <td data-row="9" data-col="3">2.21</td>
                  <td data-row="9" data-col="4">11.88</td>
                  <td data-row="9" data-col="5">1.62</td>
                  <td data-row="9" data-col="6">-1.27</td>
                  <td data-row="9" data-col="7">0.08</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="1">age</td>
                  <td data-row="10" data-col="2">27.27</td>
                  <td data-row="10" data-col="3">5.37</td>
                  <td data-row="10" data-col="4">25.32</td>
                  <td data-row="10" data-col="5">5.06</td>
                  <td data-row="10" data-col="6">-1.95</td>
                  <td data-row="10" data-col="7">0.24</td>
                </tr>
                <tr>
                  <td data-row="11" data-col="1">drinks</td>
                  <td data-row="11" data-col="2">0.03</td>
                  <td data-row="11" data-col="3">0.47</td>
                  <td data-row="11" data-col="4">0.19</td>
                  <td data-row="11" data-col="5">1.23</td>
                  <td data-row="11" data-col="6">0.16</td>
                  <td data-row="11" data-col="7">0.05</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>The things that stand out to me are:</p>
<ul>
<li><p>Birthweight tends to be notably lower for smokers relative to non-smokers. The difference is about 7.4% lower birthweight for babies whose mothers smoked.</p></li>
<li><p>That said, smoking is also correlated with a number of other things that could be related to lower birthweights. Mothers who smoke went to fewer pre-natal visits on average, were more likely to be unmarried, were more likely to have drink alcohol during their pregnancy, were more likely to be less educated. They also were, on average, somewhat younger than mothers who did not smoke.</p></li>
</ul>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + educ + nprevist + age + alcohol, 
    data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2728.91  -305.26    24.69   359.63  2220.42 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2924.963     74.185  39.428  &lt; 2e-16 ***
smoker      -206.507     27.367  -7.546 5.93e-14 ***
educ           5.644      5.532   1.020    0.308    
nprevist      32.979      2.914  11.318  &lt; 2e-16 ***
age            2.360      2.178   1.083    0.279    
alcohol      -39.512     76.365  -0.517    0.605    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 570.3 on 2994 degrees of freedom
Multiple R-squared:  0.07402,   Adjusted R-squared:  0.07247 
F-statistic: 47.86 on 5 and 2994 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here we estimate that smoking reduces an infant’s birthweight by about 200 grams on average holding education, number of pre-natal visits, age, and whether or not the mother consumed alcohol constant. The magnitude of the estimated effect is somewhat smaller than the previous estimate. Due to the discussion in #2 (particularly, that smoking was correlated with a number of other characteristics that are likely associated with lower birthweights), this decrease in the magnitude is not surprising.</p>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> <span class="fu">I</span>(smoker<span class="sc">*</span>age) <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + I(smoker * age) + educ + 
    nprevist + age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2722.56  -305.12    23.93   363.43  2244.67 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     2853.819     77.104  37.013  &lt; 2e-16 ***
smoker           231.578    134.854   1.717 0.086036 .  
I(smoker * age)  -17.145      5.168  -3.317 0.000919 ***
educ               4.895      5.528   0.885 0.375968    
nprevist          32.482      2.913  11.151  &lt; 2e-16 ***
age                5.528      2.375   2.328 0.019999 *  
alcohol          -22.556     76.409  -0.295 0.767864    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 569.4 on 2993 degrees of freedom
Multiple R-squared:  0.07741,   Adjusted R-squared:  0.07556 
F-statistic: 41.85 on 6 and 2993 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We should be careful about the interpretatio here. We have estimated a model like</p>
<p><span class="math display">\[
  \E[Birthweight|Smoker, Age, X] = \beta_0 + \beta_1 Smoker + \beta_2 Smoker \cdot Age + \cdots
\]</span> Therefore, the partial effect of smoking is given by</p>
<p><span class="math display">\[
  \E[Birthweight | Smoker=1, Age, X] - \E[Birthweight | Smoker=0, Age, X] = \beta_1 + \beta_2 Age
\]</span> Therefore, the partial effect of smoking depends on <span class="math inline">\(Age\)</span>. For example, for <span class="math inline">\(Age=18\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (18)\)</span>. For <span class="math inline">\(Age=25\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (25)\)</span>, and for <span class="math inline">\(Age=35\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (35)\)</span>. Let’s calculate the partial effect at each of those ages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>bet1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg4)[<span class="dv">2</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>bet2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg4)[<span class="dv">3</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>pe_18 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">18</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>pe_25 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">25</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>pe_35 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">35</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind.data.frame</span>(pe_18, pe_25, pe_35),<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        pe_18   pe_25   pe_35
smoker -77.04 -197.05 -368.51</code></pre>
</div>
</div>
<p>This suggests substantially larger effects of smoking on birthweight for older mothers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>reg5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> <span class="fu">I</span>(smoker<span class="sc">*</span>alcohol) <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + I(smoker * alcohol) + educ + 
    nprevist + age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2728.99  -304.16    24.54   359.92  2222.10 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         2924.844     74.185  39.426  &lt; 2e-16 ***
smoker              -201.852     27.765  -7.270 4.57e-13 ***
I(smoker * alcohol) -151.860    152.717  -0.994    0.320    
educ                   5.612      5.532   1.014    0.310    
nprevist              32.844      2.917  11.260  &lt; 2e-16 ***
age                    2.403      2.178   1.103    0.270    
alcohol               39.824    110.440   0.361    0.718    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 570.3 on 2993 degrees of freedom
Multiple R-squared:  0.07432,   Adjusted R-squared:  0.07247 
F-statistic: 40.05 on 6 and 2993 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The point estimate suggests that the effect of smoking is larger for women who consume alcohol and smoke than for women who do not drink alcohol. This seems plausible, but our evidence is not very strong here — the estimates are not statistically significant at any conventional significance level (the p-value is equal to 0.32).</p>
<ol start="6" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>reg6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ age + I(age^2), data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2949.81  -312.81    30.43   371.03  2452.72 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2502.8949   225.6016  11.094  &lt; 2e-16 ***
age           58.1670    16.9212   3.438 0.000595 ***
I(age^2)      -0.9099     0.3099  -2.936 0.003353 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 589.6 on 2997 degrees of freedom
Multiple R-squared:  0.009261,  Adjusted R-squared:  0.0086 
F-statistic: 14.01 on 2 and 2997 DF,  p-value: 8.813e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg6, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>,<span class="dv">40</span>)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">preds=</span>preds, <span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>,<span class="dv">40</span>)), <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>preds)) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"predicted values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-regression_inference_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The figure suggests that predicted birthweight is increasing in mother’s age up until about age 34 and then decreasing after that.</p>
<ol start="7" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>reg7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(<span class="fu">log</span>(birthweight)) <span class="sc">~</span> smoker <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = I(log(birthweight)) ~ smoker + educ + nprevist + 
    age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.96324 -0.07696  0.02435  0.12092  0.50070 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.9402678  0.0270480 293.562  &lt; 2e-16 ***
smoker      -0.0635764  0.0099782  -6.372 2.16e-10 ***
educ         0.0022169  0.0020171   1.099    0.272    
nprevist     0.0129662  0.0010624  12.205  &lt; 2e-16 ***
age          0.0003059  0.0007941   0.385    0.700    
alcohol     -0.0181053  0.0278428  -0.650    0.516    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2079 on 2994 degrees of freedom
Multiple R-squared:  0.07322,   Adjusted R-squared:  0.07167 
F-statistic: 47.31 on 5 and 2994 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The estimated coefficient on <span class="math inline">\(smoker\)</span> says that smoking during pregnancy decreases a baby’s birthweight by 6.3%, on average, holding education, number of pre-natal visits, age of the mother, and whether or not the mother consumed alcohol during the pregnancy constant.</p>
</section>
<section id="coding-questions" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="coding-questions"><span class="header-section-number">11.4</span> Coding Questions</h2>
<ol type="1">
<li><p>For this problem, we will use the data <code>Caschool</code>. This data contains information about test scores for schools from California from the 1998-1999 academic year. For this problem, we will use the variables <code>testscr</code> (average test score in the school), <code>str</code> (student teacher ratio in the school), <code>avginc</code> (the average income in the school district), and <code>elpct</code> (the percent of English learners in the school).</p>
<ol type="a">
<li><p>Run a regression of test scores on student teacher ratio, average income, and English learners percentage. Report your results. Which regressors are statistically significant? How do you know?</p></li>
<li><p>What is the average test score across all schools in the data?</p></li>
<li><p>What is the predicted average test score for a school with a student teacher ratio of 20, average income of $30,000, and 10% English learners? How does this compare to the overall average test score from part (b)?</p></li>
<li><p>What is the predicted average test score for a school with a student teacher ratio of 15, average income of $30,000, and 10% English learners? How does this compare to your answer from part (c)?</p></li>
</ol></li>
<li><p>For this problem, we will use the data <code>intergenerational_mobility</code>.</p>
<ol type="a">
<li><p>Run a regression of child family income (<span class="math inline">\(child\_fincome\)</span>) on parents’ family income (<span class="math inline">\(parent\_fincome\)</span>). How should you interpret the estimated coefficient on parents’ family income? What is the p-value for the coefficient on parents’ family income?</p></li>
<li><p>Run a regression of <span class="math inline">\(\log(child\_fincome)\)</span> on <span class="math inline">\(parent\_fincome\)</span>. How should you interpret the estimated cofficient on <span class="math inline">\(parent\_fincome\)</span>?</p></li>
<li><p>Run a regression of <span class="math inline">\(child\_fincome\)</span> on <span class="math inline">\(\log(parent\_fincome)\)</span>. How should you interpret the estimated coefficient on <span class="math inline">\(\log(parent\_fincome)\)</span>?</p></li>
<li><p>Run a regression of <span class="math inline">\(\log(child\_fincome)\)</span> on <span class="math inline">\(\log(parent\_fincome)\)</span>. How should you interpret the estimated coefficient on <span class="math inline">\(\log(parent\_fincome)\)</span>?</p></li>
</ol></li>
<li><p>For this question, we’ll use the <code>fertilizer_2000</code> data.</p>
<ol type="a">
<li><p>Run a regression of <span class="math inline">\(\log(avyield)\)</span> on <span class="math inline">\(\log(avfert)\)</span>. How do you interpret the estimated coefficient on <span class="math inline">\(\log(avfert)\)</span>?</p></li>
<li><p>Now suppose that you additionally want to control for precipitation and the region that a country is located in. How would you do this? Estimate the model that you propose here, report the results, and interpret the coefficient on <span class="math inline">\(\log(avfert)\)</span>.</p></li>
<li><p>Now suppose that you are interested in whether the effect of fertilizer varies by region that a country is located in (while still controlling for the same covariates as in part (b)). Propose a model that can be used for this purpose. Estimate the model that you proposed, report the results, and discuss whether the effect of fertilizer appears to vary by region or not.</p></li>
</ol></li>
<li><p>For this question, we will use the data <code>mutual_funds</code>. We’ll be interested in whether mutual funds that have higher expense ratios (these are typically actively managed funds) have higher returns relative to mutual funds that have lower expense ratios (e.g., index funds). For this problem, we will use the variables <code>fund_return_3years</code>, <code>investment_type</code>, <code>risk_rating</code>, <code>size_type</code>, <code>fund_net_annual_expense_ratio</code>, <code>asset_cash</code>, <code>asset_stocks</code>, <code>asset_bonds</code>.</p>
<ol type="a">
<li><p>Calculate the median <code>fund_net_annual_expense_ratio</code>.</p></li>
<li><p>Use the <code>datasummary_balance</code> function from the <code>modelsummary</code> package to report summary statistics for <code>fund_return_3year</code>, <code>fund_net_annual_expense_ratio</code>, <code>risk_rating</code>, <code>asset_cash</code>, <code>asset_stocks</code>, <code>asset_bonds</code> based on whether their expense ratio is above or below the median. Do you notice any interesting patterns?</p></li>
<li><p>Run a regression of <code>fund_return_3years</code> on <code>fund_net_annual_expense_ratio</code>. How do you interpret the results?</p></li>
<li><p>Now, additionally control for <code>investment_type</code>, <code>risk_rating</code>, and <code>size_type</code> <strong>Hint:</strong> think carefully about what type of variables each of these are and how they should enter the model. How do these results compare to the ones from part c?</p></li>
<li><p>Now, add the variables <code>assets_cash</code>, <code>assets_stocks</code>, and <code>assets_bonds</code> to the model from part d.&nbsp;How do you interpret these results? Compare and interpret the differences between parts c, d, and e.</p></li>
</ol></li>
<li><p>For this question, we’ll use the data <code>Lead_Mortality</code> to study the effect of lead pipes on infant mortality in 1900.</p>
<ol type="a">
<li><p>Run a regression of infant mortality (<code>infrate</code>) on whether or not a city had lead pipes (<code>lead</code>) and interpret/discuss the results.</p></li>
<li><p>It turns out that the amount of lead in drinking water depends on how acidic the water is, with more acidic water leaching more of the lead (so that there is more exposure to lead with more acidic water). To measure acidity, we’ll use the pH of the water in a particular city (<code>ph</code>); recall that, a lower value of pH indicates higher acidity. Run a regression of infant mortality on whether or not a city has lead pipes, the pH of its water, and the interaction between having lead pipes and pH. Report your results. What is the estimated partial effect of having lead pipes from this model?</p></li>
<li><p>Given the results in part b, calculate an estimate of the average partial effect of having lead pipes on infant mortality.</p></li>
<li><p>Given the results in part b, how much does the partial effect of having lead pipes differ for cities that have a pH of 6.5 relative to a pH of 7.5?</p></li>
</ol></li>
</ol>
</section>
<section id="extra-questions" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="extra-questions"><span class="header-section-number">11.5</span> Extra Questions</h2>
<ol type="1">
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  Earnings = \beta_0 + \beta_1 Education + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  Earnings = \beta_0 + \beta_1 Education + \beta_2 Experience + \beta_3 Female + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education, Experience, Female] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>Suppose you are interested in testing whether an extra year of education increases earnings by the same amount for men and women.</p>
<ol type="a">
<li><p>Propose a regression and strategy for this sort of test.</p></li>
<li><p>Suppose you also want to control for experience in conducting this test, how would do it?</p></li>
</ol></li>
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  \log(Earnings) = \beta_0 + \beta_1 Education + \beta_2 Experience + \beta_3 Female + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education, Experience, Female] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>A common extra condition (though somewhat old-fashioned) is to impose <em>homoskedasticity</em>. Homoskedasticity says that <span class="math inline">\(\E[U^2|X] = \sigma^2\)</span> (i.e., the variance of the error term does not change across different values of <span class="math inline">\(X\)</span>).</p>
<ol type="a">
<li><p>Under homoskedasticity, the expression for <span class="math inline">\(V\)</span> in <a href="#eq-V" class="quarto-xref">Equation&nbsp;<span class="quarto-unresolved-ref">eq-V</span></a> simplifies. Provide a new expression for <span class="math inline">\(V\)</span> under homoskedasticity. <strong>Hint:</strong> you will need to use the law of iterated expectations.</p></li>
<li><p>Using this expression for <span class="math inline">\(V\)</span>, explain how to calculate standard errors for an estimate of <span class="math inline">\(\beta_1\)</span> in a simple linear regression.</p></li>
<li><p>Explain how to construct a t-statistic for testing <span class="math inline">\(H_0: \beta_1=0\)</span> under homoskedasticity.</p></li>
<li><p>Explain how to contruct a p-value for <span class="math inline">\(\beta_1\)</span> under homoskedasticity.</p></li>
<li><p>Explain how to construct a 95% confidence interval for <span class="math inline">\(\beta_1\)</span> under homoskedasticity.</p></li>
</ol></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-regression_computation.html" class="pagination-link  aria-label=" &lt;span="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Computation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-binary_outcomes.html" class="pagination-link" aria-label="<span class='chapter-number'>12</span>&nbsp; <span class='chapter-title'>Binary Outcome Models</span>">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Binary Outcome Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>