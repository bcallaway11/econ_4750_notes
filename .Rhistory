# make some predictions
dt.reg1 <- lm(Y ~ 1:time.periods)
length(Y)
length(1:time.periods)
# make some predictions
dt.reg1 <- lm(Y ~ 1:time.periods)
delt <- 0.1
b0 <- 0
Y[1] = b0 + delt*1 + rnorm(1)
delt <- 0.1
b0 <- 0
Y[1] = b0 + delt*1 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + delt*t + rnorm(1)
}
Yoos <- Y[total.time.periods]
Y <- Y[1:time.periods]
plot.df <- data.frame(t=1:time.periods, Y=Y)
ggplot(data=plot.df, mapping=aes(x=t, y=Y)) +
geom_line(color="darkred", lwd=1.2) +
geom_abline(intercept=b0, slope=delt, color="darkgreen", lwd=1.2)
# make some predictions
dt.reg1 <- lm(Y ~ 1:time.periods)
time.periods
# make some predictions
tper <- 1:time.periods
tper
dt.reg1 <- lm(Y ~ tper)
summary(dt.reg1)
# forecast error
Yoos - predict(dt.reg1, newdata=data.frame(tper=101))
# forecast error
Yhat1 <- predict(dt.reg1, newdata=data.frame(tper=101))
Yhat1
Yoos
Yoos - Yhat1
dt.reg2 <- lm(Y[-1] ~ Y[-time.periods])
summary(dt.reg2)
Yt <- Y[-1]
Ylag <- Y[-time.periods]
dt.reg2 <- lm(Yt ~ Ylag)
Yhat2 <- predict(dt.reg2, newdata=data.frame(Ylag=Y[time.periods]))
Yoos - Yhat2
delt <- 0.1
b0 <- 0
Y[1] = b0 + delt*1 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + delt*t + rnorm(1)
}
Yoos <- Y[total.time.periods]
Y <- Y[1:time.periods]
plot.df <- data.frame(t=1:time.periods, Y=Y)
ggplot(data=plot.df, mapping=aes(x=t, y=Y)) +
geom_line(color="darkred", lwd=1.2) +
geom_abline(intercept=b0, slope=delt, color="darkgreen", lwd=1.2)
# make some predictions
tper <- 1:time.periods
dt.reg1 <- lm(Y ~ tper)
Yt <- Y[-1]
Ylag <- Y[-time.periods]
dt.reg2 <- lm(Yt ~ Ylag)
# forecast error
Yhat1 <- predict(dt.reg1, newdata=data.frame(tper=101))
Yoos - Yhat1
Yhat2 <- predict(dt.reg2, newdata=data.frame(Ylag=Y[time.periods]))
Yoos - Yhat2
delt <- 0.1
b0 <- 0
Y[1] = b0 + delt*1 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + delt*t + rnorm(1)
}
Yoos <- Y[total.time.periods]
Y <- Y[1:time.periods]
plot.df <- data.frame(t=1:time.periods, Y=Y)
ggplot(data=plot.df, mapping=aes(x=t, y=Y)) +
geom_line(color="darkred", lwd=1.2) +
geom_abline(intercept=b0, slope=delt, color="darkgreen", lwd=1.2)
# make some predictions
tper <- 1:time.periods
dt.reg1 <- lm(Y ~ tper)
Yt <- Y[-1]
Ylag <- Y[-time.periods]
dt.reg2 <- lm(Yt ~ Ylag)
# forecast error
Yhat1 <- predict(dt.reg1, newdata=data.frame(tper=101))
Yoos - Yhat1
Yhat2 <- predict(dt.reg2, newdata=data.frame(Ylag=Y[time.periods]))
Yoos - Yhat2
?forecast
# predict more periods ahead
forecast(dt.reg1, h=5)
# random walk
b0 <- 0
Y[1] <- b0 + rnorm(1)
for (t in 2:total.tiime.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
}
# random walk
b0 <- 0
Y[1] <- b0 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
}
# random walk
b0 <- 0
Y[1] <- b0 + rnorm(1)
X[1] <- b0 + rnorm(1)
Z[1] <- b0 + rnorm(1)
X <- Z <- c()
Y[1] <- b0 + rnorm(1)
X[1] <- b0 + rnorm(1)
Z[1] <- b0 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
X[t] <- b0 + X[t-1] + rnorm(1)
Z[t] <- b0 + Z[t-1] + rnorm(1)
}
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
Y <- Y[1:time.periods]
X <- X[1:time.periods]
Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
?tidyr::pivot_longer
?tidyr::pivot_longer
# change the format of data frame, wide 2 long
tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df, mapping=aes(x=t, y=value))
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value))
ggplot(data=plot.df2, mapping=aes(x=t, y=value))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom.line(lwd=1.2)
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(lwd=1.2)
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2)
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# spurious regression
spur.reg <- lm(Y ~ Z)
summary(spur.reg)
Yoos <- Y[total.time.periods]
Yoos <- Y[total.time.periods]
Xoos <- X[total.time.periods]
Zoos <- Z[total.time.periods]
Y <- Y[1:time.periods]
X <- X[1:time.periods]
Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# random walk
b0 <- 0
X <- Z <- c()
Y[1] <- b0 + rnorm(1)
X[1] <- b0 + rnorm(1)
Z[1] <- b0 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
X[t] <- b0 + X[t-1] + rnorm(1)
Z[t] <- b0 + Z[t-1] + rnorm(1)
}
Yoos <- Y[total.time.periods]
Xoos <- X[total.time.periods]
Zoos <- Z[total.time.periods]
Y <- Y[1:time.periods]
X <- X[1:time.periods]
Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# spurious regression
spur.reg <- lm(Y ~ Z)
summary(spur.reg)
predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat1 <- predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat2 <- Y[time.periods]
#forecast error
Yoos - Yhat1
Yoos - Yhat2
# random walk
b0 <- 0
X <- Z <- c()
Y[1] <- b0 + rnorm(1)
X[1] <- b0 + rnorm(1)
Z[1] <- b0 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
X[t] <- b0 + X[t-1] + rnorm(1)
Z[t] <- b0 + Z[t-1] + rnorm(1)
}
Yoos <- Y[total.time.periods]
Xoos <- X[total.time.periods]
Zoos <- Z[total.time.periods]
Y <- Y[1:time.periods]
X <- X[1:time.periods]
Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# spurious regression
spur.reg <- lm(Y ~ Z)
summary(spur.reg)
Yhat1 <- predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat2 <- Y[time.periods]
#forecast error
Yoos - Yhat1
Yoos - Yhat2
library(readxl)
us_macro_monthly <- read_excel("Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
View(us_macro_monthly)
# gdp data
head(us_macro_monthly)
class(us_macro_monthly$freq)
class(us_macro_monthly$EXUSUK)
months(us_macro_monthly$freq)
us_macro_monthly <- us_macro_monthly[months(us_macro_monthly$freq) == "January"]
us_macro_monthly <- us_macro_monthly[months(us_macro_monthly$freq) == "January",]
nrow(us_macro_monthly)
# gdp data
haven::read_excel
# gdp data
us_macro_monthly <- read_excel("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
head(us_macro_monthly)
# gdp data
us_macro_monthly <- readxl::read_excel("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
head(us_macro_monthly)
class(us_macro_monthly$EXUSUK)
View(us_macro_monthly)
library(haven)
birthweight_smoking <- read_dta("Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/Birthweight and Smoking (EE 5.3, 6.1, 7.1, 9.2)/birthweight_smoking.dta")
View(birthweight_smoking)
head(birthweight_smoking)
library(tidyverse)
?group_by
mean(birthweight_smoking$birthweight)
mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight)
# make some summary statistics
data <- group_by(birhtweight_smoking)
# make some summary statistics
data <- group_by(birthweight_smoking)
data
?summarize
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize(n=n())
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize(n=n(), age=mean(age))
# make some summary statistics
birthweight_smoking %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alchohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
# make some summary statistics
birthweight_smoking %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
# run regression with no covariates
lm(birthweight ~ smoker, data=birthweight_smoking)
# run regression with no covariates
r1 <- lm(birthweight ~ smoker, data=birthweight_smoking)
summary(r1)
r2 <- lm(birthweight ~ . , data=birthweight_smoking)
summary(r2)
?select
# approach 2, matching
mahalanobis(select(birthweight_smoking, !smoker))
select(birthweight_smoking, !smoker)
?mahalanobis
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1)
nonsmokers <- filter(birthweight_smoking, smoker==0)
this_x <- select(smokers, !smoker)[1,]
this_x
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
j <- 1
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
this_smoker - this_nonsmoker
this_smoker <- select(smokers, !smoker)[1,]
source('~/.active-rstudio-document', echo=TRUE)
this_smoker <- select(smokers, !smoker)[1,]
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
this_smoker - this_nonsmoker
this_nonsmoker <- as.numeric(filter(nonsmokers, !smoker)[j,])
this_smoker <- as.numeric(select(smokers, !smoker)[1,])
this_nonsmoker <- as.numeric(filter(nonsmokers, !smoker)[j,])
this_smoker - this_nonsmoker
this_smoker
cbind(this_smoker, this_nonsmoker)
length(this_smoker)
length(this_nonsmoker)
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1)
nonsmokers <- filter(birthweight_smoking, smoker==0)
this_smoker <- as.numeric(select(smokers, !smoker)[1,])
this_nonsmoker <- as.numeric(select(nonsmokers, !smoker)[j,])
this_smoker - this_nonsmoker
this_diff <- this_smoker - this_nonsmoker
?select
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(c(!smoker, !birthweight))
this_smoker <- as.numeric(smokers[i,])
i <-1
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_diff
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(c(!smoker, !birthweight))
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_nonsmoker
smokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker)
smokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight)
smokers
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker and !birthweight)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker and !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight)
nonsmokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight)
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_diff
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight & !tripre3)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight & !tripre3)
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
sum(this_diff^2)
dist <- sum(this_diff^2)
match_quality <- matrix(nrow=nrow(smokers), ncol=ncol(nonsmokers))
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_quality
which.min(match_quality)
match_idx <- which.min(match_quality)
match <- nonsmokers[match_idx,]
match
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
}
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
cat(i)
}
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
if (i %% 10 == 0) {
cat(i, "\n")
}
}
matched_data <- rbind.data.frame(smokers, nonsmokers[match_idx,])
nrow(matched_data)
match_idx
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
smokers$smoker <-1
nonsmokers$smoker <- 0
matched_data <- rbind.data.frame(smokers, nonsmokers[match_idx,])
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
devtools::install_github("rstudio/packrat")
remove.packages("packrat")
devtools::install_github("rstudio/packrat")
library(packrat)
remove.packages("packrat")
install.packages("packrat")
load("us_data.RData")
getwd()
setwd("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Detailed Course Notes")
load("us_data.RData")
ecdf(us_data$incwage)(50000)
ecdf(us_data$incwage)(20000)
ecdf(us_data$incwage)(100000)
20*60
19.8*60
knitr::opts_chunk$set(echo = TRUE)
vec <- seq(1,511,length.out=23)
log(vec, base=2)
vec <- seq(1,511,length.out=23)[13]
log(vec, base=2)
b <- seq(1,511,length.out=23)[13]
b <- log(b, base=2)
sqrt(b)
proc.time()
length(b)
