Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# spurious regression
spur.reg <- lm(Y ~ Z)
summary(spur.reg)
predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat1 <- predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat2 <- Y[time.periods]
#forecast error
Yoos - Yhat1
Yoos - Yhat2
# random walk
b0 <- 0
X <- Z <- c()
Y[1] <- b0 + rnorm(1)
X[1] <- b0 + rnorm(1)
Z[1] <- b0 + rnorm(1)
for (t in 2:total.time.periods) {
Y[t] <- b0 + Y[t-1] + rnorm(1)
X[t] <- b0 + X[t-1] + rnorm(1)
Z[t] <- b0 + Z[t-1] + rnorm(1)
}
Yoos <- Y[total.time.periods]
Xoos <- X[total.time.periods]
Zoos <- Z[total.time.periods]
Y <- Y[1:time.periods]
X <- X[1:time.periods]
Z <- Z[1:time.periods]
plot.df <- data.frame(t=1:time.periods, X=X, Y=Y, Z=Z)
# change the format of data frame, wide 2 long
plot.df2 <- tidyr::pivot_longer(plot.df, cols=c("X","Y","Z"))
ggplot(data=plot.df2, mapping=aes(x=t, y=value)) +
geom_line(aes(color=name), lwd=1.2) +
theme_bw()
# spurious regression
spur.reg <- lm(Y ~ Z)
summary(spur.reg)
Yhat1 <- predict(spur.reg, newdata=data.frame(Z=Zoos))
Yhat2 <- Y[time.periods]
#forecast error
Yoos - Yhat1
Yoos - Yhat2
library(readxl)
us_macro_monthly <- read_excel("Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
View(us_macro_monthly)
# gdp data
head(us_macro_monthly)
class(us_macro_monthly$freq)
class(us_macro_monthly$EXUSUK)
months(us_macro_monthly$freq)
us_macro_monthly <- us_macro_monthly[months(us_macro_monthly$freq) == "January"]
us_macro_monthly <- us_macro_monthly[months(us_macro_monthly$freq) == "January",]
nrow(us_macro_monthly)
# gdp data
haven::read_excel
# gdp data
us_macro_monthly <- read_excel("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
head(us_macro_monthly)
# gdp data
us_macro_monthly <- readxl::read_excel("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/US Macro Monthly and Quarterly Data (EE 15.1, 16.1, 16.2, 16.3, 17.1, 17.2)/us_macro_monthly.xlsx")
head(us_macro_monthly)
class(us_macro_monthly$EXUSUK)
View(us_macro_monthly)
library(haven)
birthweight_smoking <- read_dta("Dropbox/Courses/Georgia/Undergrad Econometrics/Fall 2020/Econometrics 4e Data Files/Birthweight and Smoking (EE 5.3, 6.1, 7.1, 9.2)/birthweight_smoking.dta")
View(birthweight_smoking)
head(birthweight_smoking)
library(tidyverse)
?group_by
mean(birthweight_smoking$birthweight)
mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff <- mean(subset(birthweight_smoking, smoker==1)$birthweight) - mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight)
diff/mean(subset(birthweight_smoking, smoker==0)$birthweight)
# make some summary statistics
data <- group_by(birhtweight_smoking)
# make some summary statistics
data <- group_by(birthweight_smoking)
data
?summarize
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize(n=n())
# make some summary statistics
birthweight_smoking %>% group_by(smoker) %>% summarize(n=n(), age=mean(age))
# make some summary statistics
birthweight_smoking %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alchohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
# make some summary statistics
birthweight_smoking %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
# run regression with no covariates
lm(birthweight ~ smoker, data=birthweight_smoking)
# run regression with no covariates
r1 <- lm(birthweight ~ smoker, data=birthweight_smoking)
summary(r1)
r2 <- lm(birthweight ~ . , data=birthweight_smoking)
summary(r2)
?select
# approach 2, matching
mahalanobis(select(birthweight_smoking, !smoker))
select(birthweight_smoking, !smoker)
?mahalanobis
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1)
nonsmokers <- filter(birthweight_smoking, smoker==0)
this_x <- select(smokers, !smoker)[1,]
this_x
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
j <- 1
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
this_smoker - this_nonsmoker
this_smoker <- select(smokers, !smoker)[1,]
source('~/.active-rstudio-document', echo=TRUE)
this_smoker <- select(smokers, !smoker)[1,]
this_nonsmoker <- filter(nonsmokers, !smoker)[j,]
this_smoker - this_nonsmoker
this_nonsmoker <- as.numeric(filter(nonsmokers, !smoker)[j,])
this_smoker <- as.numeric(select(smokers, !smoker)[1,])
this_nonsmoker <- as.numeric(filter(nonsmokers, !smoker)[j,])
this_smoker - this_nonsmoker
this_smoker
cbind(this_smoker, this_nonsmoker)
length(this_smoker)
length(this_nonsmoker)
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1)
nonsmokers <- filter(birthweight_smoking, smoker==0)
this_smoker <- as.numeric(select(smokers, !smoker)[1,])
this_nonsmoker <- as.numeric(select(nonsmokers, !smoker)[j,])
this_smoker - this_nonsmoker
this_diff <- this_smoker - this_nonsmoker
?select
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(c(!smoker, !birthweight))
this_smoker <- as.numeric(smokers[i,])
i <-1
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_diff
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(c(!smoker, !birthweight))
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_nonsmoker
smokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(c(!smoker, !birthweight))
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker)
smokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight)
smokers
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker and !birthweight)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker and !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight))
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight)
nonsmokers
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight)
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
this_diff
# approach 2, matching
smokers <- filter(birthweight_smoking, smoker==1) %>% select(!smoker & !birthweight & !tripre3)
nonsmokers <- filter(birthweight_smoking, smoker==0) %>% select(!smoker & !birthweight & !tripre3)
this_smoker <- as.numeric(smokers[i,])
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
sum(this_diff^2)
dist <- sum(this_diff^2)
match_quality <- matrix(nrow=nrow(smokers), ncol=ncol(nonsmokers))
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_quality
which.min(match_quality)
match_idx <- which.min(match_quality)
match <- nonsmokers[match_idx,]
match
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
}
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
cat(i)
}
match_idx <- c()
for (i in 1:nrow(smokers)) {
match_quality <- c()
this_smoker <- as.numeric(smokers[i,])
for (j in 1:nrow(nonsmokers)) {
this_nonsmoker <- as.numeric(nonsmokers[j,])
this_diff <- this_smoker - this_nonsmoker
dist <- sum(this_diff^2)
match_quality[j] <- dist
}
match_idx[i] <- which.min(match_quality)
if (i %% 10 == 0) {
cat(i, "\n")
}
}
matched_data <- rbind.data.frame(smokers, nonsmokers[match_idx,])
nrow(matched_data)
match_idx
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
smokers$smoker <-1
nonsmokers$smoker <- 0
matched_data <- rbind.data.frame(smokers, nonsmokers[match_idx,])
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre3=mean(tripre3),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
matched_data %>%
group_by(smoker) %>%
summarize(n=n(),
age=mean(age),
educ=mean(educ),
unmarried=mean(unmarried),
alcohol=mean(alcohol),
drinks=mean(drinks),
tripre1=mean(tripre1),
tripre2=mean(tripre2),
tripre0=mean(tripre0),
nprevist=mean(nprevist)
)
devtools::install_github("rstudio/packrat")
remove.packages("packrat")
devtools::install_github("rstudio/packrat")
library(packrat)
remove.packages("packrat")
install.packages("packrat")
install.packages("Ecdat")
devtools::install_github("jrnold/masteringmetrics")
devtools::install_github("jrnold/masteringmetrics/masteringmetrics")
1+1;3+3
data("banks", package="masteringmetrics")
head(banks)
nrow(banks)
head(banks)
banks$bib6 == banks$bio6
banks <- subset(banks, month(banks$date)==7 & mday(banks$data)==1)
library(lubridate)
banks <- subset(banks, month(banks$date)==7 & mday(banks$data)==1)
library(lubridate)
data("banks", package="masteringmetrics")
banks <- subset(banks, month(banks$date)==7 & mday(banks$data)==1)
banks <- subset(banks, month(banks$date)==7 & mday(banks$date)==1)
nrow(banks)
data("banks", package="masteringmetrics")
banks <- subset(banks, month(banks$date)==7L & mday(banks$date)==1L)
nrow(banks)
head(banks)
library(dplyr)
banks
banks <- banks[,c("date", "bib6", "bib8")]
head(banks)
pivot_wider
library(tidyr)
colnames(banks) <- c("data", "nbanks_dist6", "nbanks_dist8")
banks
pivot_longer(banks, cols=c(nbanks_dist6, nbanks_dist8))
data("banks", package="masteringmetrics")
banks <- subset(banks, month(banks$date)==7L & mday(banks$date)==1L)
banks <- banks[,c("date", "bib6", "bib8")]
colnames(banks) <- c("date", "nbanks_dist6", "nbanks_dist8")
pivot_longer(banks,
cols=c(nbanks_dist6, nbanks_dist8))
pivot_longer(banks,
cols=c(nbanks_dist6, nbanks_dist8),
names_to="district",
names_prefix="nbanks_dist6"
values_to="nbanks")
pivot_longer(banks,
cols=c(nbanks_dist6, nbanks_dist8),
names_to="district",
names_prefix="nbanks_dist6",
values_to="nbanks")
pivot_longer(banks,
cols=c(nbanks_dist6, nbanks_dist8),
names_to="district",
names_prefix="nbanks_dist",
values_to="nbanks")
library(ggplot2)
library(ggplot2)
banks
ggplot(banks, aes(x=date, y=nbanks_dist6)) +
geom_line() +
geom_point() +
geom_line(aes(y=nbanks_dist8)) +
geom_point()
ggplot(banks, aes(x=date, y=nbanks_dist6)) +
geom_line() +
geom_point() +
geom_line(aes(y=nbanks_dist8)) +
geom_point(aes(y=nbanks_dist8))
ggplot(banks, aes(x=date, y=nbanks_dist6)) +
geom_line(color="blah") +
geom_point(color="blah") +
geom_line(aes(y=nbanks_dist8)) +
geom_point(aes(y=nbanks_dist8))
ggplot(banks, aes(x=date, y=nbanks_dist6)) +
geom_line(color="red") +
geom_point(color="red") +
geom_line(aes(y=nbanks_dist8), color="blue") +
geom_point(aes(y=nbanks_dist8), color="blue")
ggplot(banks, aes(x=date, y=nbanks_dist6)) +
geom_line(color="blue") +
geom_point(color="blue") +
geom_line(aes(y=nbanks_dist8), color="red") +
geom_point(aes(y=nbanks_dist8), color="red")
d1 <- banks$nbanks_dist6 - banks$nbanks_dist8
length(d1)
dd <- d1[2:6] - d1[1]
dd
banks
install.packages("hdm")
data("AJR", package="hdm")
nrow(AJR)
head(AJR)
lm(GDP ~ Exprop, data=AJR)
summary(lm(GDP ~ Exprop, data=AJR))
summary(ivreg(GDP ~ Exprop, ~logMort, data=AJR))
library(ivreg)
summary(ivreg(GDP ~ Exprop, ~logMort, data=AJR))
mean(AJR$GDP)
max(AJR$GDP)
exp(10.22)
min(AJR$GDP)
exp(6.11)
?hdm::AJR
data(AJR, package="hdm")
data("rand_person_spend", package="masteringmetrics")
nrow(rand_person_spend)
?rand_person_spend
?masteringmetrics::rand_person_spend
head(rand_person_spend)
colnames(rand_person_spend)
rand_person_spend[,c("age","sex","race")]
install.packages("sampleSelection")
data(RandHIE, package="sampleSelection")
nrow(RandHIE)
head(RandHIE)
?sampleSelection::RandHIE
head(rand_person_spend)
data <- rand_person_spend
head(data)
View(data)
data$plan
data$plan_original
data$meddol
data <- data %>% group_by(person)
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol))
head(data2)
nrow(data2)
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol), plantype)
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol), plantype=plantype)
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol), plantype=unique(plantype))
head(data2)
data$good_health
View(RandHIE)
data$totadm
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol),
plantype=unique(plantype),
ftf=mean(ftf),
totadm=mean(totadm),
ghindx=mean(ghindx)
)
data2 <- data %>%
group_by(person) %>%
summarise(meddol = mean(meddol),
plantype=unique(plantype),
ftf=mean(ftf),
totadm=mean(totadm)
)
head(data2)
rand_hie <- as.data.frame(data2)
all(complete.cases(rand_hie))
rand_hie[!complete.cases(rand_hie), ]
rand_hie[is.na(rand_hie$totadm)]
rand_hie[is.na(rand_hie$totadm),]
rand_hie[is.na(rand_hie$totadm),"totadm"]
rand_hie[is.na(rand_hie$totadm),]$totadm
rand_hie[is.na(rand_hie$totadm),]$totadm <- 0
rand_hie[is.na(rand_hie$totadm),"totadm"]
unique(rand_person_spend$year)
load("data/rand_hie.RData")
nrow(rand_hie)
class(rand_hie)
class(rand_hie$plantype
)
head(rand_hie)
unique(rand_hie$plantype)
lm(meddol ~ plantype, data=rand_hie)
lm(ftf ~ plantype, data=rand_hie)
bookdown::render_book("index.Rmd")
setwd("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Detailed Course Notes")
setwd("~/Dropbox/Courses/Georgia/Undergrad Econometrics/Detailed Course Notes")
bookdown::render_book("index.Rmd")
head(rand_hie)
lm(meddol ~ plantype, data=rand_hie)
load("data/rand_hie.RData")
nrow(rand_hie)
load("data/rand_hie.RData")
nrow(rand_hie)
load("data/rand_hie.RData")
nrow(rand_hie)
head(rand_hie)
load("data/rand_hie.RData")
nrow(rand_hie)
lm(meddol ~ plantype, data=rand_hie)
summary(lm(total_med_expenditure ~ plan_type, data=rand_hie))
summary(lm(face_to_face_visits ~ plan_type, data=rand_hie))
summary(lm(health_index ~ plan_type, data=rand_hie))
