<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Linear Regression – Detailed Course Notes for ECON 4750</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-prediction.html" rel="next">
<link href="./03-estimators.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-linear_regression.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Detailed Course Notes for ECON 4750</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-statistical_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistical Programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-estimators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Properties of Estimators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-linear_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-binary_outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Binary Outcome Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-causal_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Causal Inference</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#nonparametric-regression-curse-of-dimensionality" id="toc-nonparametric-regression-curse-of-dimensionality" class="nav-link active" data-scroll-target="#nonparametric-regression-curse-of-dimensionality"><span class="header-section-number">5.1</span> Nonparametric Regression / Curse of Dimensionality</a></li>
  <li><a href="#linear-regression-models" id="toc-linear-regression-models" class="nav-link" data-scroll-target="#linear-regression-models"><span class="header-section-number">5.2</span> Linear Regression Models</a></li>
  <li><a href="#computation" id="toc-computation" class="nav-link" data-scroll-target="#computation"><span class="header-section-number">5.3</span> Computation</a></li>
  <li><a href="#partial-effects" id="toc-partial-effects" class="nav-link" data-scroll-target="#partial-effects"><span class="header-section-number">5.4</span> Partial Effects</a>
  <ul class="collapse">
  <li><a href="#computation-1" id="toc-computation-1" class="nav-link" data-scroll-target="#computation-1"><span class="header-section-number">5.4.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#binary-regressors" id="toc-binary-regressors" class="nav-link" data-scroll-target="#binary-regressors"><span class="header-section-number">5.5</span> Binary Regressors</a>
  <ul class="collapse">
  <li><a href="#computation-2" id="toc-computation-2" class="nav-link" data-scroll-target="#computation-2"><span class="header-section-number">5.5.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#nonlinear-regression-functions" id="toc-nonlinear-regression-functions" class="nav-link" data-scroll-target="#nonlinear-regression-functions"><span class="header-section-number">5.6</span> Nonlinear Regression Functions</a>
  <ul class="collapse">
  <li><a href="#computation-3" id="toc-computation-3" class="nav-link" data-scroll-target="#computation-3"><span class="header-section-number">5.6.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#interpreting-interaction-terms" id="toc-interpreting-interaction-terms" class="nav-link" data-scroll-target="#interpreting-interaction-terms"><span class="header-section-number">5.7</span> Interpreting Interaction Terms</a>
  <ul class="collapse">
  <li><a href="#computation-4" id="toc-computation-4" class="nav-link" data-scroll-target="#computation-4"><span class="header-section-number">5.7.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#elasticities" id="toc-elasticities" class="nav-link" data-scroll-target="#elasticities"><span class="header-section-number">5.8</span> Elasticities</a>
  <ul class="collapse">
  <li><a href="#computation-5" id="toc-computation-5" class="nav-link" data-scroll-target="#computation-5"><span class="header-section-number">5.8.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#omitted-variable-bias" id="toc-omitted-variable-bias" class="nav-link" data-scroll-target="#omitted-variable-bias"><span class="header-section-number">5.9</span> Omitted Variable Bias</a></li>
  <li><a href="#how-to-estimate-the-parameters-in-a-regression-model" id="toc-how-to-estimate-the-parameters-in-a-regression-model" class="nav-link" data-scroll-target="#how-to-estimate-the-parameters-in-a-regression-model"><span class="header-section-number">5.10</span> How to estimate the parameters in a regression model</a>
  <ul class="collapse">
  <li><a href="#computation-6" id="toc-computation-6" class="nav-link" data-scroll-target="#computation-6"><span class="header-section-number">5.10.1</span> Computation</a></li>
  <li><a href="#more-than-one-regressor" id="toc-more-than-one-regressor" class="nav-link" data-scroll-target="#more-than-one-regressor"><span class="header-section-number">5.10.2</span> More than one regressor</a></li>
  </ul></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference"><span class="header-section-number">5.11</span> Inference</a>
  <ul class="collapse">
  <li><a href="#computation-7" id="toc-computation-7" class="nav-link" data-scroll-target="#computation-7"><span class="header-section-number">5.11.1</span> Computation</a></li>
  </ul></li>
  <li><a href="#lab-4-birthweight-and-smoking" id="toc-lab-4-birthweight-and-smoking" class="nav-link" data-scroll-target="#lab-4-birthweight-and-smoking"><span class="header-section-number">5.12</span> Lab 4: Birthweight and Smoking</a></li>
  <li><a href="#lab-4-solutions" id="toc-lab-4-solutions" class="nav-link" data-scroll-target="#lab-4-solutions"><span class="header-section-number">5.13</span> Lab 4: Solutions</a></li>
  <li><a href="#coding-questions" id="toc-coding-questions" class="nav-link" data-scroll-target="#coding-questions"><span class="header-section-number">5.14</span> Coding Questions</a></li>
  <li><a href="#extra-questions" id="toc-extra-questions" class="nav-link" data-scroll-target="#extra-questions"><span class="header-section-number">5.15</span> Extra Questions</a></li>
  <li><a href="#answers-to-some-extra-questions" id="toc-answers-to-some-extra-questions" class="nav-link" data-scroll-target="#answers-to-some-extra-questions"><span class="header-section-number">5.16</span> Answers to Some Extra Questions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, our interest will shift to conditional expectations, such as <span class="math inline">\(\E[Y|X_1,X_2,X_3]\)</span> (I’ll write <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, and <span class="math inline">\(X_3\)</span> in a lot of examples in this chapter, but you can think of there being an arbitrary number of <span class="math inline">\(X\)</span>’s).</p>
<p>I’ll refer to <span class="math inline">\(Y\)</span> as the <strong>outcome</strong>. You might also sometimes heae it called the <strong>dependent variable</strong>.</p>
<p>I’ll refer to the <span class="math inline">\(X\)</span>’s as either <strong>covariates</strong> or <strong>regressors</strong> or <strong>characteristics</strong>. You might also hear them called <strong>independent variables</strong> sometimes.</p>
<p>Before we start to get into the details, let us first discuss why we’re interested in conditional expectations. First, if we are interested in <em>making predictions</em>, it will often be the case that the “best” prediction that one can make is the conditional expectation. This should make sense to you — if you want to make a reasonable prediction about what the outcome will be for a new observation that has characteristics <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span>, a good way to do it would be to predict that their outcome would be the same as the mean outcome in the population among those that have the same characteristics; that is, <span class="math inline">\(\E[Y|X_1=x_1, X_2=x_2, X_3=x_3]\)</span>.</p>
<p>Next, in economics, we are often interested in how much some outcome of interest changes when a particular covariate changes, holding other covariates constants. To give some examples, we might be interested in the average return of actively managed mutual funds relative to passively managed mutual funds conditional on investing in assets in the same class (e.g., large cap stocks or international bonds). As another example, we might be interested in the effect of an increase in the amount of fertilizer on average crop yield but while holding constant the temperature and precipitation.</p>
<p>How much the outcome, <span class="math inline">\(Y\)</span>, changes on average when one of the covariates, <span class="math inline">\(X_1\)</span>, changes by 1 unit and holding other covariates constant is what we’ll call the <strong>partial effect</strong> of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>. Suppose <span class="math inline">\(X_1\)</span> is binary, then it is given by</p>
<p><span class="math display">\[
  PE(x_2,x_3) = \E[Y | X_1=1, X_2=x_2, X_3=x_3] - \E[Y | X_1=0,X_2=x_2,X_3=x_3]
\]</span> Notice that the partial effect can depend on <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span>. For example, it could be that the effect of active management relative to passive management could be different across different asset classes.</p>
<p>Slightly more generally, if <span class="math inline">\(X_1\)</span> is discrete, so that it can take on several different discrete values, then we define the partial effect as</p>
<p><span class="math display">\[
  PE(x_1,x_2,x_3) = \E[Y | X_1=x_1+1, X_2=x_2, X_3=x_3] - \E[Y | X_1=x_1,X_2=x_2,X_3=x_3]
\]</span> which now can depend on <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span>. This is the average effect of going from <span class="math inline">\(X_1=x_1\)</span> to <span class="math inline">\(X_1=x_1+1\)</span> holding <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span> constant.</p>
<p>Finally, consider the case where we are interested in the partial effect of <span class="math inline">\(X_1\)</span> which is continuous (for example, the partial effect of fertilizer input on crop yield). In this case the partial effect is given by the <em>partial derivative</em> of <span class="math inline">\(\E[Y|X_1,X_2,X_3]\)</span> with respect to <span class="math inline">\(X_1\)</span>.</p>
<p><span class="math display">\[
  PE(x_1,x_2,x_3) = \frac{\partial \, \E[Y|X_1=x_1, X_2=x_2, X_3=x_3]}{\partial \, x_1}
\]</span> This partial derivative is analogous to what we have been doing before — we are making a small change of <span class="math inline">\(X_1\)</span> while holding <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span> constant at <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span>.</p>
<div class="side-comment">
<p><span class="side-comment">Side-Comment:</span> This is probably the part of the class where we will jump around in the book the most this semester.</p>
<p>The pedagogical approach of the textbook is to introduce the notion of causality very early and to emphasize the requirements on linear regression models in order to deliver causality, while increasing the complexity of the models over several chapters.</p>
<p>This is totally reasonable, but I prefer to start by teaching the mechanics of regressions: how to compute them, how to interpret them (even if you are not able to meet the requirements of causality), and how to use them to make predictions. Then, we’ll have a serious discussion about causality over the last few weeks of the semester.</p>
<p>In practice, this means we’ll cover parts Chapters 4-8 in the textbook now, and then we’ll circle back to some of the issues covered in these chapters again towards the end of the semester.</p>
</div>
<section id="nonparametric-regression-curse-of-dimensionality" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="nonparametric-regression-curse-of-dimensionality"><span class="header-section-number">5.1</span> Nonparametric Regression / Curse of Dimensionality</h2>
<p>If you knew nothing about regressions, it would seem natural to try to estimate <span class="math inline">\(\E[Y|X_1=x_1,X_2=x_2,X_3=x_3]\)</span> by just calculating the average of <span class="math inline">\(Y\)</span> among observations that have values of the regressors equal to <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span> (if these are discrete) or that are, in some sense, close to <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span> (if these are continuous).</p>
<p>This is actually a pretty attractive idea.</p>
<p>However, you run into the issue that it is practically challenging to do this when the number of regressors starts to get large (i.e., if you have 10 regressors, generally, you would need tons of data to be able to find a suitable number of observations that are “close” to any particular value of the regressors).</p>
<p>Let me give a more concrete example. Suppose that you were trying to estimate mean house price as a function of a house’s characteristics. If the only characteristic of the house that you knew was the number of bedrooms, then it would be pretty easy to just calculate the average house price among houses with 2, 3, 4, etc. bedrooms. Now suppose that you knew both the number of bedrooms and the number of square feet. In this case, if we wanted to estimate mean house prices as a function of these characteristics, we would need to find houses that have the same number of bedrooms and (at least) a similar number of square feet. This starts to “slice” the data that you have more thinly. If you continue with this idea (suppose that you want to estimate mean house price as a function of number of bedrooms, number of bathrooms, number of square feet, what year the house was built in, whether or not it has a basement, what zip code it is located in, etc.) then you will start to stretch your data extremely thin to the point that you may have very few relevant observations (or perhaps no relevant observations) for particular values of the characteristics.</p>
<p>This issue is called the “curse of dimensionality”.</p>
<p>We will focus on linear models for <span class="math inline">\(\E[Y|X_1,X_2,X_3]\)</span> largely to get around the curse of dimensionality.</p>
<div class="side-comment">
<p>This idea of using observations that are very close in terms of characteristics in order to estimate a conditional expectation is called <strong>nonparametric</strong> econometrics/statistics. You can take entire courses (typically graduate-level) on this topic if you were interested. The reason that it is is called nonparametric is that it doesn’t involve making any functional form assumptions (like linearity) but the cost is that it would typically require many more observations (due to the curse of dimensionality).</p>
</div>
</section>
<section id="linear-regression-models" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="linear-regression-models"><span class="header-section-number">5.2</span> Linear Regression Models</h2>
<p>SW 4.1</p>
<p>In order to get around the curse of dimensionality that we discussed in the previous section, we will often an impose a <strong>linear model</strong> for the conditional expectation. For example,</p>
<p><span class="math display">\[
  \E[Y|X] = \beta_0 + \beta_1 X
\]</span> or</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2,X_3] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3
\]</span> If we know the values of <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, and <span class="math inline">\(\beta_3\)</span>, then it is straighforward for us to make predictions. In particular, suppose that we want to predict the outcome for a new observation with characteristics <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span>. Our prediction would be</p>
<p><span class="math display">\[
  \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3
\]</span></p>
<div class="example">
<p>Suppose that you are studying intergenerational income mobility and that you are interested in predicting a child’s income whose parents’ income was $50,000 and whose mother had 12 years of education. Let <span class="math inline">\(Y\)</span> denote child’s income, <span class="math inline">\(X_1\)</span> denote parents’ income, and <span class="math inline">\(X_2\)</span> denote mother’s education. Further, suppose that <span class="math inline">\(\E[Y|X_1,X_2] = 20,000 + 0.5 X_1 + 1000 X_2\)</span>.</p>
<p>In this case, you would predict child’s income to be</p>
<p><span class="math display">\[
  20,000 + 0.5 (50,000) + 1000(12) = 57,000
\]</span></p>
</div>
<div class="side-comment">
<p><span class="side-comment">Side-Comment:</span></p>
<p>The above model can be equivalently written as <span class="math display">\[\begin{align*}
  Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3 + U
\end{align*}\]</span> where <span class="math inline">\(U\)</span> is called the <strong>error term</strong> and satisfies <span class="math inline">\(\E[U|X_1,X_2,X_3] = 0\)</span>. There will be a few times where this formulation will be useful for us.</p>
</div>
</section>
<section id="computation" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="computation"><span class="header-section-number">5.3</span> Computation</h2>
<p>Even if we know that <span class="math inline">\(\E[Y|X_1,X_2,X_3] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3\)</span>, in general, we do not know the values of the population parameters (the <span class="math inline">\(\beta\)</span>’s). This is analogous to the framework in the previous chapter where we were interested in the population parameter <span class="math inline">\(\E[Y]\)</span> and estimated it by <span class="math inline">\(\bar{Y}\)</span>.</p>
<p>In this section, we’ll discuss how to estimate <span class="math inline">\((\beta_0,\beta_1,\beta_2,\beta_3)\)</span> using <code>R</code>. We’ll refer to the estimated values of the parameters as <span class="math inline">\((\hat{\beta}_0, \hat{\beta}_1, \hat{\beta}_2, \hat{\beta}_3)\)</span>. As in the previous section, it will not be the case that the estimated <span class="math inline">\(\hat{\beta}\)</span>’s are exactly equal to the population <span class="math inline">\(\beta\)</span>’s. Later on in this chapter, we will establish properties like consistency (so that, as long as we have a large sample, the estimated <span class="math inline">\(\hat{\beta}\)</span>’s should be “close” to the population <span class="math inline">\(\beta\)</span>’s) and asymptotic normality (so that we can conduct inference).</p>
<p>Also later on in this chapter, we’ll talk about how <code>R</code> itself actually makes these computations.</p>
<p>The main function in <code>R</code> for estimating linear regressions is the <code>lm</code> function (<code>lm</code> stands for linear model). The key things to specify for running a regression in <code>R</code> are a <code>formula</code> argument which tells <code>lm</code> which variables are the outcome and which variables are the regressors and a <code>data</code> argument which tells the <code>lm</code> command what data we are using to estimate the regression. Let’s give an example using the <code>mtcars</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data=</span>mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What this line of code does is to run a regression. The formula is <code>mpg ~ hp + wt</code>. In other words <code>mpg</code> (standing for miles per gallon) is the outcome, and we are running a regression on <code>hp</code> (horse power) and <code>wt</code> (weight). The <code>~</code> symbol is a “tilde”. In order to add regressors, we separate them with a <code>+</code>. The second argument <code>data=mtcars</code> says to use the <code>mtcars</code> data. All of the variables in the formula need to correspond to column names in the data. We saved the results of the regression in a variable called <code>reg</code>. It’s most common to report the results of the regression using the <code>summary</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
<p>The main thing that this reports is the estimated parameters. Our estimate of the “Intercept” (i.e., this is <span class="math inline">\(\hat{\beta}_0\)</span>) is in the first row of the table; our estimate is <code>37.227</code>. The estimated coefficient on <code>hp</code> is <code>-0.0318</code>, and the estimated coefficient on <code>wt</code> is <code>-3.878</code>.</p>
<p>You can also see standard errors for each estimated parameter, a t-statistic, and a p-value in the other columns. We will talk about these in more detail in the next section.</p>
<p>For now, we’ll also ignore the information provided at the bottom of the summary.</p>
<p>Now that we have estimated the parameters, we can use these to predict <span class="math inline">\(mpg\)</span> given a value of <span class="math inline">\(hp\)</span> and <span class="math inline">\(wt\)</span>. For example, suppose that you wanted to predict the <span class="math inline">\(mpg\)</span> of a 2500 pound car (note: weight in <span class="math inline">\(mtcars\)</span> is in 1000s of pounds) and 120 horsepower car, you could compute</p>
<p><span class="math display">\[
  37.227 - 0.0318(120) - 3.878(2.5) = 23.716
\]</span> Alternatively, there is a built-in function in <code>R</code> called <code>predict</code> that can be used to generate predicted values. We just need to specify the values that we would like to get predicted values for by passing in a data frame with the relevant columns though the <code>newdata</code> argument. For example,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">hp=</span><span class="dv">120</span>,<span class="at">wt=</span><span class="fl">2.5</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pred,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1 
23.72 </code></pre>
</div>
</div>
<div class="side-comment">
<p>A popular alternative to <code>R</code>’s <code>lm</code> function is the <code>lm_robust</code> function from the <code>estimatr</code> package. This provides different standard errors from the default standard errors provided by <code>lm</code> that are, at least in most applications in economics, typically a better choice — we’ll have a further discussion on this topic when we talk about inference later on in this chapter.</p>
</div>
</section>
<section id="partial-effects" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="partial-effects"><span class="header-section-number">5.4</span> Partial Effects</h2>
<p>As we discussed in the beginning of this chapter, besides predicting outcomes, a second main goal for us is to think about partial effects of a regressor on the outcome. We’ll consider partial effects over the next few sections.</p>
<p>In the model, <span class="math display">\[\begin{align*}
  \E[Y | X_1, X_2, X_3]  &amp;= \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3
\end{align*}\]</span></p>
<p>If <span class="math inline">\(X_1\)</span> is continuous, then <span class="math display">\[\begin{align*}
  \beta_1 = \frac{\partial \E[Y|X_1,X_2,X_3]}{\partial X_1}
\end{align*}\]</span></p>
<p>Thus, <span class="math inline">\(\beta_1\)</span> is the partial effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>. In other words, <span class="math inline">\(\beta_1\)</span> should be interpreted as how much <span class="math inline">\(Y\)</span> increases, on average, when <span class="math inline">\(X_1\)</span> increases by one unit holding <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span> constant. <em>Make sure to get this interpretation right!</em></p>
<div class="example">
<p>Continuing the same example as above about intergenerational income mobility and where <span class="math inline">\(Y\)</span> denotes child’s income, <span class="math inline">\(X_1\)</span> denotes parents’ income, <span class="math inline">\(X_2\)</span> denotes mother’s education, and</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2] = 20,000 + 0.5 X_1 + 1000 X_2
\]</span> The partial effect of parents’ income on child’s income is 0.5. This means that, for every one dollar increase in parents’ income, child’s income is 0.5 dollars higher on average holding mother’s education constant.</p>
</div>
<section id="computation-1" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="computation-1"><span class="header-section-number">5.4.1</span> Computation</h3>
<p>Let’s run the same regression as in the previous section, but think about partial effects in this case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data=</span>mtcars)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
<p>The partial effect of horsepower on miles per gallon is -0.032. In other words, we estimate that if horsepower increases by one then, on average, miles per gallon decreases by 0.032 holding weight constant.</p>
<p>The t-statistic and p-value are computed for the null hypothesis that the corresponding coefficient is equal to 0. For example, for <code>hp</code> the t-statistic is equal to <code>-3.519</code> which is greater than 1.96 and indicates that the partial effect of <code>hp</code> is statistically significant at a 5% significance level. The corresponding p-value for <code>hp</code> is <code>0.0145</code> indicating that there is only about a 1.5% chance of getting a t-statistic this extreme if the partial effect of <code>hp</code> were actually 0 (i.e., under <span class="math inline">\(H_0 : \beta_1=0\)</span>).</p>
<div class="practice">
<p><span class="practice">Practice: </span>What is the partial effect of <code>wt</code> in the previous example? Provide a careful interpretation. Is the partial effect of <code>wt</code> statistically significant? Explain. What is the p-value for <code>wt</code>? How do you interpret the p-value?</p>
</div>
<div class="side-comment">
<p><span class="side-comment">Side-Comment:</span> One horsepower is a very small increase in horsepower, so it might be a good idea to multiply the coefficient by some larger number, say 50. In this case, we could say that we estimate that if horsepower increases by 50 then, on average, miles per gallon decreases by 1.59 (<span class="math inline">\(=50 \times 0.03177\)</span>) holding weight constant. From the above discussion, we know that this effect is statistically different from 0. That said, it is not clear to me if we should interpret this as a large partial effect; I do not know too much about cars, but a 50 horsepower increase seems rather large while a 1.59 decrease in miles per gallon seems relatively small (at least to me).</p>
</div>
</section>
</section>
<section id="binary-regressors" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="binary-regressors"><span class="header-section-number">5.5</span> Binary Regressors</h2>
<p>SW 5.3</p>
<p>Let’s continue with the same model as above</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2,X_3] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3
\]</span></p>
<p>If <span class="math inline">\(X_1\)</span> is discrete (let’s say binary): <span class="math display">\[\begin{align*}
  \beta_1 = \E[Y|X_1=1,X_2,X_3] - \E[Y|X_1=0,X_2,X_3]
\end{align*}\]</span> <span class="math inline">\(\beta_1\)</span> is still the partial effect of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> and should be interpreted as how much <span class="math inline">\(Y\)</span> increases, on average, when <span class="math inline">\(X_1\)</span> changes from 0 to 1, holding <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span> constant.</p>
<p>If <span class="math inline">\(X_1\)</span> can take more than just the values 0 and 1, but is still discrete (an example is a person’s years of education), then</p>
<p><span class="math display">\[
  \beta_1 = \E[Y | X_1=x_1+1, X_2, X_3] - \E[Y|X_1=x_1, X_2, X_3]
\]</span> which holds for any possible value that <span class="math inline">\(X_1\)</span> could take, so that <span class="math inline">\(\beta_1\)</span> is the effect of a 1 unit increase in <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span>, on average, holding constant <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_3\)</span>.</p>
<div class="example">
<p>Suppose that you work for an airline and you are interested in predicting the number of passengers for a Saturday morning flight from Atlanta to Memphis. Let <span class="math inline">\(Y\)</span> denote the number of passengers, <span class="math inline">\(X_1\)</span> be equal to 1 for a morning flight and 0 otherwise, and let <span class="math inline">\(X_2\)</span> be equal to 1 for a weekday flight and 0 otherwise. Further suppose that <span class="math inline">\(\E[Y|X_1,X_2] = 80 + 20 X_1 - 15 X_2\)</span>.</p>
<p>In this case, you would predict,</p>
<p><span class="math display">\[
  80 + 20 (1) - 15 (0) = 100
\]</span> passengers on the flight.</p>
<p>In addition, the partial effect of being morning flight is equal to 20. This indicates that, on average, morning flights have 20 more passengers than non-morning flights holding whether or not the flight occurs on a weekday constant.</p>
</div>
<section id="computation-2" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="computation-2"><span class="header-section-number">5.5.1</span> Computation</h3>
<p>In order to include a binary or discrete covariate in a regression in <code>R</code> is straightforward. The following regression uses the <code>mtcars</code> data and adds a binary regressor, <code>am</code>, indicating whether or not a car has an automatic transmission.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> am, <span class="at">data=</span>mtcars)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + am, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4221 -1.7924 -0.3788  1.2249  5.5317 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 34.002875   2.642659  12.867 2.82e-13 ***
hp          -0.037479   0.009605  -3.902 0.000546 ***
wt          -2.878575   0.904971  -3.181 0.003574 ** 
am           2.083710   1.376420   1.514 0.141268    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.538 on 28 degrees of freedom
Multiple R-squared:  0.8399,    Adjusted R-squared:  0.8227 
F-statistic: 48.96 on 3 and 28 DF,  p-value: 2.908e-11</code></pre>
</div>
</div>
<p>In this example, cars that had an automatic transmission got about 2 more miles per gallon than cars that had an automatic transmission on average, holding horsepower and weight constant (though the p-value is only 0.14).</p>
</section>
</section>
<section id="nonlinear-regression-functions" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="nonlinear-regression-functions"><span class="header-section-number">5.6</span> Nonlinear Regression Functions</h2>
<p>SW 8.1, 8.2</p>
<p>Also, please read all of SW Ch. 8</p>
<p>So far, the the partial effects that we have been interested in have corresponded to a particular parameter in the regression, usually <span class="math inline">\(\beta_1\)</span>. I think this can sometimes be a source of confusion as, at least in my view, we are not typically interested in the parameters for their own sake, but rather are interested in partial effects. It just so happens that in some leading cases, they coincide.</p>
<p>In addition, while the <span class="math inline">\(\beta\)</span>’s in the sort of models we have considered so far are easy to interpret, in some cases, it might be <em>restrictive</em> to think that the partial effects are the same across different values of the covariates.</p>
<p>In this section, we’ll see the first of several cases where partial effects do not coincide with a particular parameter.</p>
<p>Suppose that</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2,X_3] = \beta_0 + \beta_1 X_1 + \beta_2 X_1^2 + \beta_3 X_2 + \beta_4 X_3
\]</span></p>
<p>Let’s start with making predictions using this model. If you know the values of <span class="math inline">\(\beta_0,\beta_1,\beta_2,\beta_3,\)</span> and <span class="math inline">\(\beta_4\)</span>, then to get a prediction, you would still just plug in the values of the regressors that you’d like to get a prediction for (including <span class="math inline">\(x_1^2\)</span>).</p>
<p>Next, in this model, the partial effect of <span class="math inline">\(X_1\)</span> is given by</p>
<p><span class="math display">\[
  \frac{\partial \, \E[Y|X_1,X_2,X_3]}{\partial \, X_1} = \beta_1 + 2\beta_2 X_1
\]</span> In other words, the partial effect of <span class="math inline">\(X_1\)</span> depends on the value that <span class="math inline">\(X_1\)</span> takes.</p>
<p>In this case, it is sometimes useful to report the partial effect for some different values of <span class="math inline">\(X_1\)</span>. In other cases, it is useful to report the <strong>average partial effect</strong> (APE) which is the mean of the partial effects across the distribution of the covariates. In this case, the APE is given by</p>
<p><span class="math display">\[
  APE = \beta_1 + 2 \beta_2 \E[X_1]
\]</span> and, once you have estimated the regression, you can compute an estimate of <span class="math inline">\(APE\)</span> by</p>
<p><span class="math display">\[
  \widehat{APE} = \hat{\beta}_1 + 2 \hat{\beta}_2 \bar{X}_1
\]</span></p>
<div class="example">
<p>Let’s continue our example on intergenerational income mobility where <span class="math inline">\(Y\)</span> denotes child’s income, <span class="math inline">\(X_1\)</span> denotes parents’ income, and <span class="math inline">\(X_2\)</span> denotes mother’s education. Now, suppose that</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2] = 15,000 + 0.7 X_1 - 0.000002 X_1^2 + 800 X_2
\]</span> Then, predicted child’s income when parents’ income is equal to $50,000 is given by</p>
<p><span class="math display">\[
  15,000 + 0.7 (50,000) - 0.000002 (50,000)^2 + 800 (12) = 54,600
\]</span> In addition, the partial effect of parents’ income is given by</p>
<p><span class="math display">\[
  0.7 - 0.000004 X_1
\]</span> Let’s compute a few different partial effects for different values of parents’ income</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_1\)</span></th>
<th style="text-align: center;">PE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">20,000</td>
<td style="text-align: center;">0.62</td>
</tr>
<tr class="even">
<td style="text-align: center;">50,000</td>
<td style="text-align: center;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: center;">100,000</td>
<td style="text-align: center;">0.30</td>
</tr>
</tbody>
</table>
<p>which indicates that the partial effect of parents’ income is decreasing — i.e., the effect of additional parents’ income is largest for children whose parents have the lowest income and gets smaller for those whose parents have high incomes.</p>
<p>Finally, if you wanted to compute the <span class="math inline">\(APE\)</span>, you would just plug in <span class="math inline">\(\E[X_1]\)</span> (or <span class="math inline">\(\bar{X}_1\)</span>) into the expression for the partial effect.</p>
</div>
<section id="computation-3" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="computation-3"><span class="header-section-number">5.6.1</span> Computation</h3>
<p>Including a quadratic (or other higher order term) in <code>R</code> is relatively straightforward. Let’s just do an example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>mtcars)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + I(hp^2), data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5512 -1.6027 -0.6977  1.5509  8.7213 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.041e+01  2.741e+00  14.744 5.23e-15 ***
hp          -2.133e-01  3.488e-02  -6.115 1.16e-06 ***
I(hp^2)      4.208e-04  9.844e-05   4.275 0.000189 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.077 on 29 degrees of freedom
Multiple R-squared:  0.7561,    Adjusted R-squared:  0.7393 
F-statistic: 44.95 on 2 and 29 DF,  p-value: 1.301e-09</code></pre>
</div>
</div>
<p>The only thing that is new here is <code>I(hp^2)</code>. The <code>I</code> function stands for inhibit (you can read the documentation using <code>?I</code>). For us, this is not too important. You can understand it like this: there is no variable names <code>hp^2</code> in the data, but if we put the name of a variable that is in the data (here: <code>hp</code>) then we can apply a function to it (here: squaring it) before including it as a regressor.</p>
<p>Interestingly, here it seems there are nonlinear effects of horsepower on miles per gallon. Let’s just quickly report the estimated partial effects for a few different values of horsepower.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>hp_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># there might be a native function in r</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to compute these partial effects; I just</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># don't know it.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="cf">function</span>(hp) {</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># partial effect is b1 + 2b2*hp</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  pes <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg3)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(reg3)[<span class="dv">3</span>]<span class="sc">*</span>hp</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print using a data frame</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">hp=</span>hp, <span class="at">pe=</span><span class="fu">round</span>(pes,<span class="dv">3</span>))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pe</span>(hp_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   hp     pe
1 100 -0.129
2 200 -0.045
3 300  0.039</code></pre>
</div>
</div>
<p>which suggests that the partial effect of horsepower on miles per gallon is large (though negative) at small values of horsepower and decreasing up to essentially no effect at larger values of horsepower.</p>
</section>
</section>
<section id="interpreting-interaction-terms" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="interpreting-interaction-terms"><span class="header-section-number">5.7</span> Interpreting Interaction Terms</h2>
<p>SW 8.3</p>
<p>Another way to allow for partial effects that vary across different values of the regressors is to include <strong>interaction terms</strong>.</p>
<p>Consider the following regression model</p>
<p><span class="math display">\[
  \E[Y|X_1,X_2,X_3] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + \beta_4 X_3
\]</span></p>
<p>The term <span class="math inline">\(X_1 X_2\)</span> is called the interaction term. In this model, the partial effect of <span class="math inline">\(X_1\)</span> is given by</p>
<p><span class="math display">\[
  \frac{\partial \, \E[Y|X_1,X_2,X_3]}{\partial \, X_1} = \beta_1 + \beta_3 X_2
\]</span></p>
<p>In this model, the effect of <span class="math inline">\(X_1\)</span> varies with <span class="math inline">\(X_2\)</span>. As in the previous section, you could report the partial effect for different values of <span class="math inline">\(X_2\)</span> or consider <span class="math inline">\(APE = \beta_1 + \beta_3 \E[X_2]\)</span>.</p>
<p>There are a couple of other things worth pointing out for interaction terms</p>
<ul>
<li><p>It is very common for one of the interaction terms, say, <span class="math inline">\(X_2\)</span> to be a binary variable. This gives a way to easily test if the effect of <span class="math inline">\(X_1\)</span> is the same across the two “groups” defined by <span class="math inline">\(X_2\)</span>. For example, suppose you wanted to check if the partial effect of education was the same for men and women. You could run a regression like</p>
<p><span class="math display">\[
    Wage = \beta_0 + \beta_1 Education + \beta_2 Female + \beta_3 Education \cdot Female + U
  \]</span></p>
<p>From the previous discussion, the partial effect of education is given by</p>
<p><span class="math display">\[
    \beta_1 + \beta_3 Female
  \]</span></p>
<p>Thus, the partial effect education for men is given by <span class="math inline">\(\beta_1\)</span>, and the partial effect of education for women is given by <span class="math inline">\(\beta_1 + \beta_3\)</span>. Thus, if you want to test if the partial effect of education differs for men and women, you can just test if <span class="math inline">\(\beta_3=0\)</span>. If <span class="math inline">\(\beta_3&gt;0\)</span>, it suggests a higher partial effect of education for women, and if <span class="math inline">\(\beta_3 &lt; 0\)</span>, it suggests a lower partial effect of education for women.</p></li>
<li><p>Another interesting case is when <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are both binary. In this case, a model that includes an interaction term is called a <strong>saturated model</strong>. It is called this because it is actually nonparametric. In particular, notice that in the model <span class="math inline">\(\E[Y|X_1,X_2] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2\)</span>,</p>
<p><span class="math display">\[
  \begin{aligned}
    \E[Y|X_1=0,X_2=0] &amp;= \beta_0 \\
    \E[Y|X_1=1,X_2=0] &amp;= \beta_0 + \beta_1 \\
    \E[Y|X_1=0,X_2=1] &amp;= \beta_0 + \beta_2 \\
    \E[Y|X_1=1,X_2=1] &amp;= \beta_0 + \beta_1 + \beta_2 + \beta_3
  \end{aligned}
  \]</span></p>
<p>This exhausts all possible combinations of the regressors and means that you can recover each possible value of the conditional expectation from the parameters of the model.</p>
<p>It would be possible to write down a saturated model in cases with more than two binary regressors (or even discrete regressors) — you would just need to include more interaction terms. The key thing is that there be no continuous regressors. That said, as you start to add more and more discrete regressors and their interactions, you will effectively start to run into the curse of dimensionality issues that we discussed earlier.</p>
<p>As an example, consider our earlier example of flights from Atlanta to Memphis where <span class="math inline">\(Y\)</span> denoted the number of passengers, <span class="math inline">\(X_1\)</span> was equal to 1 for a a morning flight and 0 otherwise, and <span class="math inline">\(X_2\)</span> was equal to one for a weekday flight and 0 otherwise. Suppose that <span class="math inline">\(\E[Y|X_1,X_2] = 90 - 15 X_1 - 5 X_2 + 25 X_1 X_2\)</span>. Then,</p>
<p><span class="math display">\[
  \begin{aligned}
    \E[Y|X_1=0,X_2=0] &amp;= 90 \quad &amp; \textrm{non-morning, weekend} \\
    \E[Y|X_1=1,X_2=0] &amp;= 90 - 15 = 75 \quad &amp; \textrm{morning, weekend} \\
    \E[Y|X_1=0,X_2=1] &amp;= 90 - 5 = 85 \quad  &amp; \textrm{non-morning, weekday} \\
    \E[Y|X_1=1,X_2=1] &amp;= 90 - 15 - 5 + 25 = 100 \quad &amp; \textrm{morning, weekend}
  \end{aligned}
  \]</span></p></li>
</ul>
<section id="computation-4" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="computation-4"><span class="header-section-number">5.7.1</span> Computation</h3>
<p>Including interaction terms in regressions in <code>R</code> is straightforward. Using the <code>mtcars</code> data, we can do it as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> am <span class="sc">+</span> hp<span class="sc">*</span>am, <span class="at">data=</span>mtcars)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + am + hp * am, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.435 -1.510 -0.697  1.284  5.245 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 33.34196    2.79711  11.920 2.89e-12 ***
hp          -0.02918    0.01449  -2.014  0.05407 .  
wt          -3.05617    0.94036  -3.250  0.00309 ** 
am           3.55141    2.35742   1.506  0.14355    
hp:am       -0.01129    0.01466  -0.770  0.44809    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.556 on 27 degrees of freedom
Multiple R-squared:  0.8433,    Adjusted R-squared:  0.8201 
F-statistic: 36.33 on 4 and 27 DF,  p-value: 1.68e-10</code></pre>
</div>
</div>
<p>The interaction term in the results is in the row that starts with <code>hp:am</code>. These estimates suggest that, while horsepower does seem to decrease miles per gallon controlling for weight and whether or not the car has an automatic transmission, the effect of horsepower does not seem to vary much by whether or not the car has an automatic transmission (at least not in a big enough way that we can detect it with the data that we have).</p>
</section>
</section>
<section id="elasticities" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="elasticities"><span class="header-section-number">5.8</span> Elasticities</h2>
<p>SW 8.2</p>
<p>Economists are often interested in <strong>elasticities</strong>, that is, the percentage change in <span class="math inline">\(Y\)</span> when <span class="math inline">\(X\)</span> changes by 1%.</p>
<p>Recall that the definition of percentage change of moving from, say, <span class="math inline">\(x_{old}\)</span> to <span class="math inline">\(x_{new}\)</span> is given by</p>
<p><span class="math display">\[
  \textrm{\% change} = \frac{x_{new} - x_{old}}{x_{old}} \times 100
\]</span></p>
<p>Elasticities are closely connected to natural logarithms; following the most common notation in economics, we’ll refer to the natural logarithm using the notation: <span class="math inline">\(\log\)</span>. Further, recall that the derivative of the <span class="math inline">\(\log\)</span> function is given by</p>
<p><span class="math display">\[
  \frac{d \, \log(x)}{d \, x} = \frac{1}{x} \implies d\, \log(x) = \frac{d \, x}{x}
\]</span> which further implies that</p>
<p><span class="math display">\[
  \Delta \log(x) := \log(x_{new}) - \log(x_{old}) \approx \frac{x_{new} - x_{old}}{x_{old}}
\]</span> and, thus, that</p>
<p><span class="math display">\[
  100 \cdot \Delta \log(x) \approx \textrm{\% change}
\]</span> where the approximation is better when <span class="math inline">\(x_{new}\)</span> and <span class="math inline">\(x_{old}\)</span> are close to each other.</p>
<p>Now, we’ll use these properties of logarithms in order to interpret several linear models</p>
<ul>
<li><p>For simplicity, I am going to not include an error term or extra covariates, but you should continue to interpret parameter estimates as “on average” and “holding other regressors constant” (if there are other regressors in the model).</p></li>
<li><p><strong>Log-Log</strong> Model</p>
<p><span class="math display">\[
  \log(Y) = \beta_0 + \beta_1 \log(X)
  \]</span></p>
<p>In this case,</p>
<p><span class="math display">\[
  \begin{aligned}
  \beta_1 &amp;= \frac{ d \, \log(Y) }{d \, \log(X)} \\
  &amp;= \frac{ d \, \log(Y) \cdot 100 }{d \, \log(X) \cdot 100} \\
  &amp;\approx \frac{ \% \Delta Y}{ \% \Delta X}
  \end{aligned}
  \]</span></p>
<p>All that to say, in a regression of the log of an outcome on the log of a regressor, you should interpret the corresponding coefficient as the average percentage change in the outcome when the regressor changes by 1%. The log-log model is sometimes called a <strong>constant elasticity</strong> model.</p></li>
<li><p><strong>Log-Level</strong> model</p>
<p><span class="math display">\[
  \log(Y) = \beta_0 + \beta_1 X
  \]</span></p>
<p>In this case,</p>
<p><span class="math display">\[
  \begin{aligned}
  \beta_1 &amp;= \frac{ d \, \log(Y) }{d \, X} \\
  \implies 100 \beta_1 &amp;= \frac{ d \, \log(Y) \cdot 100 }{d \, X} \\
  \implies 100 \beta_1 &amp;\approx \frac{ \% \Delta Y}{ d \, X}
  \end{aligned}
  \]</span></p>
<p>Thus, in a regression of the log of an outcome on the <em>level</em> of a regressor, you should multiply the corresponding coefficient by 100 and interpret it as the average percentage change in the outcome when the regressor changes by 1 unit.</p></li>
<li><p><strong>Level-Log</strong> model</p>
<p><span class="math display">\[
    Y = \beta_0 + \beta_1 \log(X)
  \]</span></p>
<p>In this case,</p>
<p><span class="math display">\[
    \begin{aligned}
    \beta_1 &amp;= \frac{d\, Y}{d \, \log(X)} \\
    \implies \frac{\beta_1}{100} &amp;= \frac{d \, Y}{d \, \log(X) \cdot 100} \\
    \implies \frac{\beta_1}{100} &amp;\approx \frac{d \, Y}{\% \Delta X}
    \end{aligned}
  \]</span></p>
<p>Thus, in a regression of the level of an outcome on the log of a regressor, you should divide the corresponding coefficient by 100 and interpret it as the average change in the outcome when the regressor changes by 1%.</p></li>
</ul>
<div class="example">
<p>Let’s continue the same example on intergenerational income mobility where <span class="math inline">\(Y\)</span> denotes child’s income, <span class="math inline">\(X_1\)</span> denotes parents’ income and <span class="math inline">\(X_2\)</span> denotes mother’s education. We’ll consider how to interpret several different models.</p>
<p><span class="math display">\[
  \log(Y) = 8.8 + 0.4 \log(X_1) + 0.008 X_2 + U
\]</span> In this model, we estimate that, on average, when parents’ income increases by 1%, child’s income increases by 0.4% holding mother’s education constant.</p>
<p>Next, consider, <span class="math display">\[
  \log(Y) = 8.9 + 0.00004 X_1 + 0.007 X_2 + U
\]</span> In this model, we estimate that, on average, when parents’ income increases by $1, child’s income increases by 0.004% (alternatively, when parents’ income increase by $1000, child’s income increases by 4%) holding mother’s education constant.</p>
<p>Finally, consider</p>
<p><span class="math display">\[
  Y = -1,680,000 + 160,000 \log(X_1) + 900 X_2 + U
\]</span> In this case, we estimate that, on average, when parents’ income increases by 1%, child’s income increases by $1,600 holding mother’s education constant.</p>
</div>
<section id="computation-5" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="computation-5"><span class="header-section-number">5.8.1</span> Computation</h3>
<p>Estimating models that include logarithms in <code>R</code> is straightforward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>reg5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(hp) <span class="sc">+</span> wt, <span class="at">data=</span>mtcars) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>reg6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data=</span>mtcars) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>reg7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">log</span>(hp) <span class="sc">+</span> wt, <span class="at">data=</span>mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s show the results all at once using the <code>modelsummary</code> function from the <code>modelsummary</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(reg5, reg6, reg7)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(model_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_qarhtayi3x7psxx2gynw</title>
    <style>
.table td.tinytable_css_4oioc82l7621a6zd74gf, .table th.tinytable_css_4oioc82l7621a6zd74gf {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_k07csoe7567cki4t3uyd, .table th.tinytable_css_k07csoe7567cki4t3uyd {    text-align: left; }
.table td.tinytable_css_sukx4bd5q8p4sw050gv5, .table th.tinytable_css_sukx4bd5q8p4sw050gv5 {    text-align: center; }
.table td.tinytable_css_u23oqw30052ecusyjogc, .table th.tinytable_css_u23oqw30052ecusyjogc {    text-align: center; }
.table td.tinytable_css_urkdm2zqe87sojsywx8x, .table th.tinytable_css_urkdm2zqe87sojsywx8x {    text-align: center; }
.table td.tinytable_css_c2zscdufr3m2m7rfuh0z, .table th.tinytable_css_c2zscdufr3m2m7rfuh0z {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_qarhtayi3x7psxx2gynw" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
                <th scope="col">(2)</th>
                <th scope="col">(3)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>4.832  </td>
                  <td>3.829  </td>
                  <td>59.571 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.222)</td>
                  <td>(0.069)</td>
                  <td>(4.977)</td>
                </tr>
                <tr>
                  <td>log(hp)    </td>
                  <td>-0.266 </td>
                  <td>       </td>
                  <td>-5.922 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.056)</td>
                  <td>       </td>
                  <td>(1.266)</td>
                </tr>
                <tr>
                  <td>wt         </td>
                  <td>-0.179 </td>
                  <td>-0.201 </td>
                  <td>-3.286 </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.027)</td>
                  <td>(0.027)</td>
                  <td>(0.615)</td>
                </tr>
                <tr>
                  <td>hp         </td>
                  <td>       </td>
                  <td>-0.002 </td>
                  <td>       </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>       </td>
                  <td>(0.000)</td>
                  <td>       </td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>32     </td>
                  <td>32     </td>
                  <td>32     </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.885  </td>
                  <td>0.869  </td>
                  <td>0.859  </td>
                </tr>
                <tr>
                  <td>R2 Adj.    </td>
                  <td>0.877  </td>
                  <td>0.860  </td>
                  <td>0.849  </td>
                </tr>
                <tr>
                  <td>AIC        </td>
                  <td>140.3  </td>
                  <td>144.5  </td>
                  <td>150.0  </td>
                </tr>
                <tr>
                  <td>BIC        </td>
                  <td>146.1  </td>
                  <td>150.4  </td>
                  <td>155.9  </td>
                </tr>
                <tr>
                  <td>Log.Lik.   </td>
                  <td>28.501 </td>
                  <td>26.395 </td>
                  <td>-71.017</td>
                </tr>
                <tr>
                  <td>F          </td>
                  <td>111.812</td>
                  <td>96.232 </td>
                  <td>88.442 </td>
                </tr>
                <tr>
                  <td>RMSE       </td>
                  <td>0.10   </td>
                  <td>0.11   </td>
                  <td>2.23   </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_hulrfnx6e1xlc8ydipm0(i, j, css_id) {
        var table = document.getElementById("tinytable_qarhtayi3x7psxx2gynw");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_qarhtayi3x7psxx2gynw');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_hulrfnx6e1xlc8ydipm0(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_qarhtayi3x7psxx2gynw");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 0, 'tinytable_css_4oioc82l7621a6zd74gf') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 1, 'tinytable_css_4oioc82l7621a6zd74gf') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 2, 'tinytable_css_4oioc82l7621a6zd74gf') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 3, 'tinytable_css_4oioc82l7621a6zd74gf') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(1, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(2, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(3, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(4, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(5, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(6, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(7, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(9, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(10, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(11, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(12, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(13, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(14, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(15, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(16, 0, 'tinytable_css_k07csoe7567cki4t3uyd') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(1, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(2, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(3, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(4, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(5, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(6, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(7, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(9, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(10, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(11, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(12, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(13, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(14, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(15, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(16, 1, 'tinytable_css_sukx4bd5q8p4sw050gv5') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(1, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(2, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(3, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(4, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(5, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(6, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(7, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(9, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(10, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(11, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(12, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(13, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(14, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(15, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(16, 2, 'tinytable_css_u23oqw30052ecusyjogc') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(0, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(1, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(2, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(3, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(4, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(5, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(6, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(7, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(9, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(10, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(11, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(12, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(13, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(14, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(15, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(16, 3, 'tinytable_css_urkdm2zqe87sojsywx8x') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 0, 'tinytable_css_c2zscdufr3m2m7rfuh0z') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 1, 'tinytable_css_c2zscdufr3m2m7rfuh0z') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 2, 'tinytable_css_c2zscdufr3m2m7rfuh0z') })
window.addEventListener('load', function () { styleCell_tinytable_hulrfnx6e1xlc8ydipm0(8, 3, 'tinytable_css_c2zscdufr3m2m7rfuh0z') })
    </script>

  


</div>
</div>
<ul>
<li><p>In the first model, we estimate that, on average, a 1% increase in horsepower decreases miles per gallon by 0.266% holding weight constant.</p></li>
<li><p>In the second model, we estimate that, on average, a 1 unit increase in horsepower decreases miles per gallon by 0.2% holding weight constant.</p></li>
<li><p>In the third model, we estimate that, on average, a 1% increase in horsepower decreases miles per gallon by .059 holding weight constant.</p></li>
</ul>
</section>
</section>
<section id="omitted-variable-bias" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="omitted-variable-bias"><span class="header-section-number">5.9</span> Omitted Variable Bias</h2>
<p>SW 6.1</p>
<p>Suppose that we are interested in the following regression model</p>
<p><span class="math display">\[
  \E[Y|X_1, X_2, Q] = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 Q
\]</span> and, in particular, we are interested in the the partial effect</p>
<p><span class="math display">\[
  \frac{ \partial \, \E[Y|X_1,X_2,Q]}{\partial \, X_1} = \beta_1
\]</span> But we are faced with the issue that we do not observe <span class="math inline">\(Q\)</span> (which implies that we cannot control for it in the regression)</p>
<p>Recall that we can equivalently write</p>
<p><span class="math display">\[
  Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 Q + U (\#eq:ovb-y)
\]</span> where <span class="math inline">\(\E[U|X_1,X_2,Q]=0\)</span>.</p>
<p>Now, for simplicity, suppose that</p>
<p><span class="math display">\[
  \E[Q | X_1, X_2] = \gamma_0 + \gamma_1 X_1 + \gamma_2 X_2
\]</span></p>
<p>Now, let’s consider the idea of just running a regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> (and just not including <span class="math inline">\(Q\)</span>); in other words, consider the regression <span class="math display">\[
  \E[Y|X_1,X_2] = \delta_0 + \delta_1 X_1 + \delta_2 X_2
\]</span> We are interested in the question of whether or not we can recover <span class="math inline">\(\beta_1\)</span> if we do this. If we consider this “feasible” regression, notice if we plug in the expression for <span class="math inline">\(Y\)</span> from Equation @ref(eq:ovb-y),</p>
<p><span class="math display">\[
  \begin{aligned}
  \E[Y|X_1,X_2] &amp;= \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 \E[Q|X_1,X_2] \\
  &amp;= \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 (\gamma_0 + \gamma_1 X_1 + \gamma_2 X_2) \\
  &amp;= \underbrace{(\beta_0 + \beta_3 \gamma_0)}_{\delta_0} + \underbrace{(\beta_1 + \beta_3 \gamma_1)}_{\delta_1} X_1 + \underbrace{(\beta_2 + \beta_3 \gamma_2)}_{\delta_2} X_2
  \end{aligned}
\]</span></p>
<p>In other words, if we run the feasible regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, <span class="math inline">\(\delta_1\)</span> (the coefficient on <span class="math inline">\(X_1\)</span>) is not equal to <span class="math inline">\(\beta_1\)</span>; rather, it is equal to <span class="math inline">\((\beta_1 + \beta_3 \gamma_1)\)</span>.</p>
<p>That you are not generally able to recover <span class="math inline">\(\beta_1\)</span> in this case is called <strong>omitted variable bias</strong></p>
<p>There are two cases where you will recover <span class="math inline">\(\delta_1 = \beta_1\)</span> though which occur when <span class="math inline">\(\beta_3 \gamma_1 = 0\)</span>:</p>
<ul>
<li><p><span class="math inline">\(\beta_3=0\)</span>. This would be the case where <span class="math inline">\(Q\)</span> has no effect on <span class="math inline">\(Y\)</span></p></li>
<li><p><span class="math inline">\(\gamma_1=0\)</span>. This would be the case where <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Q\)</span> are uncorrelated after controlling for <span class="math inline">\(X_2\)</span>.</p></li>
</ul>
<p>Interestingly, there may be some case where you can “sign” the bias; i.e., figure out if <span class="math inline">\(\beta_3 \gamma_1\)</span> is positive or negative. For example, you might have theoretical reasons to suspect that <span class="math inline">\(\gamma_1 &gt; 0\)</span> and <span class="math inline">\(\beta_3 &gt; 0\)</span>. In this case,</p>
<p><span class="math display">\[
  \delta_1 = \beta_1 + \textrm{something positive}
\]</span> which implies that <span class="math inline">\(\delta_1\)</span> (i.e., running a regression that ignores <span class="math inline">\(Q\)</span>) would cause us to tend to over-estimate <span class="math inline">\(\beta_1\)</span>.</p>
<div class="side-comment">
<p><span class="side-comment">Side-Comment:</span></p>
<ul>
<li><p>The book talks about omitted variable bias in the context of causality (this is probably the leading case), but we have not talked about causality yet. The same issues arise if we just say that we have some <em>regression of interest</em> but are unable to estimate it because some covariates are unobserved.</p></li>
<li><p>The relationship to causality (which is not so important for now), is that under certain conditions, we may have a particular partial effect that we would be willing to interpret as being the “causal effect”, but if we are unable to control for some variables that would lead to this interpretation, then we get to the issues pointed out in the textbook.</p></li>
</ul>
</div>
</section>
<section id="how-to-estimate-the-parameters-in-a-regression-model" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="how-to-estimate-the-parameters-in-a-regression-model"><span class="header-section-number">5.10</span> How to estimate the parameters in a regression model</h2>
<p>SW 4.2, 6.3</p>
<p>Let’s start with the simple linear regression model (i.e., where there is just one regressor):</p>
<p><span class="math display">\[
  Y = \beta_0 + \beta_1 X + U
\]</span> with <span class="math inline">\(\E[U|X]=0\)</span>. This model holds for every observation in the data, so we can write</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 X_i + U_i
\]</span> The question for this section is: How can we estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>? First, notice that, any choice that we make for an estimate of <span class="math inline">\(\beta_0\)</span> of <span class="math inline">\(\beta_1\)</span> amounts to picking a line. Our strategy will be to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> by choosing values of them that result in the “best fit” of a line to the available data.</p>
<p>This begs the question: How do you choose the line that best fits the data? Let me give you an example</p>
<p><img src="ols_lines.jpg"></p>
<p>It’s clear from the figure that the blue line “fits better” than the green line or the red line. If you take a second and think about the reason why this is the case, you will notice that the reason why you know that it fits better is because the points <em>tend to be closer</em> to the blue line than to the red line or the green line.</p>
<p>In the figure, I drew three additional lines that are labeled <span class="math inline">\(U_i^b\)</span>, <span class="math inline">\(U_i^g\)</span>, and <span class="math inline">\(U_i^r\)</span> which are just the difference between the blue line, the green line, and the red line and the corresponding data point in the figure. That is,</p>
<p><span class="math display">\[
  \begin{aligned}
  U_i^b &amp;= Y_i - b_0^b - b_1^b X_i \\
  U_i^g &amp;= Y_i - b_0^g - b_1^g X_i \\
  U_i^r &amp;= Y_i - b_0^r - b_1^r X_i
  \end{aligned}
\]</span> where, for example, <span class="math inline">\(b_0^b\)</span> and <span class="math inline">\(b_1^b\)</span> are the intercept and slope of the blue line, <span class="math inline">\(b_0^g\)</span> and <span class="math inline">\(b_1^g\)</span> are the intercept and slope of the green line, etc. Clearly, the blue line fits this data point than the others, but we need to deal with a couple of issues to formalize this thinking. First, <span class="math inline">\(U_i^b\)</span> and <span class="math inline">\(U_i^r\)</span> are both less than 0 (because both of those lines sit above the data point) indicating that we can’t just choose the line where <span class="math inline">\(U_i\)</span> is the smallest — for this point, that strategy would result in us liking the red line the most. Instead, we need a measure of distance that turns negative values of <span class="math inline">\(U_i\)</span> into positive values and is larger for big negative values of <span class="math inline">\(U_i\)</span> too. We’ll use the same quadratic distance that we’ve used before to deal with this issue; that is, we’ll define the distance between a line and the point as <span class="math inline">\({U_i^b}^2\)</span> for the blue line, <span class="math inline">\({U_i^g}^2\)</span> and <span class="math inline">\({U_i^r}^2\)</span> for the green and red lines.</p>
<p>Second, the above discussion computes the distance between the line and the data for a single point. We want to extend this argument to all the data points. And we can do that by computing the average distance between the line and the points across all points. That is given by</p>
<p><span class="math display">\[
  \frac{1}{n}\sum_{i=1}^n {U_i^b}^2, \quad \frac{1}{n}\sum_{i=1}^n {U_i^g}^2, \quad \frac{1}{n}\sum_{i=1}^n {U_i^r}^2
\]</span> for the blue line, green line, and red line. These are actually numbers that we can compute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept and slope of each line</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (I just picked these)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>int_blue <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>slope_blue <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>int_green <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>slope_green <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>int_red <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>slope_red <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute "errors"</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>Ub <span class="ot">&lt;-</span> Y <span class="sc">-</span> int_blue <span class="sc">-</span> slope_blue<span class="sc">*</span>X</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>Ug <span class="ot">&lt;-</span> Y <span class="sc">-</span> int_green <span class="sc">-</span> slope_green<span class="sc">*</span>X</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>Ur <span class="ot">&lt;-</span> Y <span class="sc">-</span> int_red <span class="sc">-</span> slope_red<span class="sc">*</span>X</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># compute distances</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>dist_blue <span class="ot">&lt;-</span> <span class="fu">mean</span>(Ub<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>dist_green <span class="ot">&lt;-</span> <span class="fu">mean</span>(Ug<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>dist_red <span class="ot">&lt;-</span> <span class="fu">mean</span>(Ur<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># report distances</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(dist_blue, dist_green, dist_red), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dist_blue dist_green dist_red
1     0.255      5.828   14.728</code></pre>
</div>
</div>
<p>This corroborates our earlier intuition — the blue line appears to fit the data much better than the other two lines.</p>
<p>It turns out that we can use the same sort of idea as above to choose not just among three possible lines to fit the data, but to choose among <em>all possible lines</em>. More generally than we have been doing, let’s write</p>
<p><span class="math display">\[
  Y_i = b_0 + b_1 X_i + U_i(b_0,b_1)
\]</span> In other words, for any values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that we would like to plug in (say like for the green line or red line in the figure above), we can define <span class="math inline">\(U_i(b_0,b_1)\)</span> to be whatever is leftover between the line and the actual data.</p>
<p>We can choose the line (by choosing values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>) that minimizes the average distance between the line and the points. In other words, we will set</p>
<p><span class="math display">\[
  \begin{aligned}
  (\hat{\beta}_0, \hat{\beta}_1) &amp;= \underset{b_0,b_1}{\textrm{argmin}} \frac{1}{n} \sum_{i=1}^n U_i(b_0,b_1)^2 \\
  &amp;= \underset{b_0,b_1}{\textrm{argmin}} \frac{1}{n} \sum_{i=1}^n (Y_i - b_0 - b_1 X_i)^2
  \end{aligned}
\]</span> This is a complicated looking mathematical expression, but I think the intuition is pretty easy to understand. It says that we want to find the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that make the distance between the points and the line as small as possible on average. Whatever these values are, that is what we are going to set <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> — our estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> — to be.</p>
<p>How can you do this? One idea is to do it numerically — you could try out a ton of different combinations of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> and pick which one fits the best. Your computer could probably actually do this, but it would become quite a hard problem as we added more and more regressors.</p>
<p>It turns out that we can actually find a solution for the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize the above expression using calculus.</p>
<p>You probably recall how to minimize a function. You take its derivative, set it equal to 0, and solve that equation. [It’s actually a little more complicated than that because you need to ensure that you’re finding a minimum rather than a maximum, but the above equation is actually quadratic, so it will have a minimum.]</p>
<p>That’s all that we will do here — just the thing we need to take the derivative of looks complicated. Actually, the <span class="math inline">\(\frac{1}{n}\)</span> and <span class="math inline">\(\sum\)</span> terms will just hang around. For the rest though, we need to use the <em>chain rule</em>; that is, we need to take the derivative of the outside and then multiply by the derivative of the inside. We also need to take the derivative both with respect to <span class="math inline">\(b_0\)</span> and with respect to <span class="math inline">\(b_1\)</span>.</p>
<p>Let’s start by taking the derivative with respect to <span class="math inline">\(b_0\)</span> and setting it equal to 0.</p>
<p><span class="math display">\[
  -\frac{2}{n}\sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i) = 0 (\#eq:foc-bet0)
\]</span> where the <span class="math inline">\(2\)</span> comes from taking the deriviative of the squared part and the negative sign at the beginning comes from taking the derivative of <span class="math inline">\(-b_0\)</span> on the inside. I also replaced <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> here since <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are the values that will solve this equation.</p>
<p>Next, let’s take the derivative with respect to <span class="math inline">\(b_1\)</span>: <span class="math display">\[
  -\frac{2}{n} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i) X_i = 0 (\#eq:foc-bet1)
\]</span><br>
where the 2 comes from taking the derivative of the squared part, and the negative sign at the beginning and <span class="math inline">\(X_i\)</span> at the end come from taking the derivative of the inside with respect to <span class="math inline">\(b_1\)</span>.</p>
<p>All we have to do now is to solve these Equations @ref(eq:foc-bet0) and @ref(eq:foc-bet1) for <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>. Before we do it, let me just mention that we are about to do some fairly challenging algebra, but that is all it is. Conceptually, it is just the same as solving a system of two equations with two unknowns that you probably did at some point in high school.</p>
<p>Starting with the first equation,</p>
<p><span class="math display">\[
  \begin{aligned}
  &amp; \phantom{\implies} -\frac{2}{n} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i) &amp;= 0 \\
  &amp; \implies \frac{1}{n} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i) &amp;= 0 \\
  &amp; \implies \bar{Y} - \hat{\beta}_0 - \hat{\beta}_1 \bar{X} &amp;= 0 \\
  &amp; \implies \boxed{\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1 \bar{X}}
  \end{aligned}
\]</span> where the second line holds by dividing both sides by <span class="math inline">\(-2\)</span>, the third line holds by pushing the summation through the sums/differences and simplifying terms, and the last line holds by rearranging to solve for <span class="math inline">\(\hat{\beta}_0\)</span>.</p>
<p>Now, let’s use the above result and Equation @ref(eq:foc-bet1) to solve for <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
<p><span class="math display">\[
  \begin{aligned}
  &amp; \phantom{\implies} -\frac{2}{n} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1) X_i &amp;= 0 \\
  &amp; \implies  \frac{1}{n} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1) X_i) X_i &amp;= 0 \\
  &amp; \implies  \frac{1}{n} \sum_{i=1}^n (Y_i - (\bar{Y} - \hat{\beta}_1 \bar{X}) - \hat{\beta}_1 X_i) X_i &amp;= 0 \\
  &amp; \implies  \frac{1}{n} \sum_{i=1}^n X_i Y_i - \bar{Y} \frac{1}{n} \sum_{i=1}^n X_i + \hat{\beta}_1 \bar{X} \frac{1}{n} \sum_{i=1}^n X_i - \hat{\beta}_1 \frac{1}{n} \sum_{i=1}^n X_i^2 &amp;= 0  \\
\end{aligned}
\]</span> Let me explain each line and then we will keep going. The second line holds because the <span class="math inline">\(-2\)</span> can just be canceled on each side, the third line holds by plugging in the expression we derived for <span class="math inline">\(\hat{\beta}_0\)</span> above, and the last line holds by splitting up the summation and bringing out terms that do not change across <span class="math inline">\(i\)</span>. Let’s keep going</p>
<p><span class="math display">\[
\begin{aligned}
  \implies  \frac{1}{n} \sum_{i=1}^n X_i Y_i - \bar{X}\bar{Y} &amp;= \hat{\beta}_1\left(\frac{1}{n} \sum_{i=1}^n X_i^2 - \bar{X}^2 \right) \\
  \implies  \hat{\beta}_1 &amp;= \frac{\frac{1}{n} \sum_{i=1}^n X_i Y_i - \bar{X}\bar{Y}}{\frac{1}{n} \sum_{i=1}^n X_i^2 - \bar{X}^2} \\
  \implies  &amp; \boxed{\hat{\beta}_1 = \frac{\widehat{\Cov}(X,Y)}{\widehat{\Var}(X)}}
  \end{aligned}
\]</span> where the first line holds by using the definition of <span class="math inline">\(\bar{X}\)</span> and moving some terms to the other side. The second equality holds by dividing both sides by <span class="math inline">\(\left(\frac{1}{n} \displaystyle \sum_{i=1}^n X_i^2 - \bar{X}^2 \right)\)</span>, and the last equality holds by the definition of sample covariance and variance.</p>
<div class="side-comment">
<p><span class="side-comment">Side-Comment:</span> I’d like to point out one more time that our estimates <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are generally not exactly equal to <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. The figure earlier in this section was generated using simulated data where I set <span class="math inline">\(\beta_0=2\)</span> and <span class="math inline">\(\beta_1=1\)</span>. However, we estimate <span class="math inline">\(\hat{\beta}_0 = 1.75\)</span> and <span class="math inline">\(\hat{\beta}_1 = 0.95\)</span> using the simulated data in that figure. These lines are close to each other, but not exactly the same.</p>
<p>Further, recall that we defined the <strong>error term</strong> <span class="math inline">\(U_i\)</span> from</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 X_i + U_i
\]</span> which is the difference between individual <span class="math inline">\(i\)</span>’s outcome and the <em>population</em> regression line.</p>
<p>Similarly, we define the <strong>residual</strong> <span class="math inline">\(\hat{U}_i\)</span> as</p>
<p><span class="math display">\[
  Y_i = \hat{\beta}_0 + \hat{\beta}_1 X_i + \hat{U}_i
\]</span> so that <span class="math inline">\(\hat{U}_i\)</span> is the difference between individual <span class="math inline">\(i\)</span>’s outcome and the estimated regression line. Moreover, since generally <span class="math inline">\(\beta_0 \neq \hat{\beta}_0\)</span> and <span class="math inline">\(\beta_1 \neq \hat{\beta}_1\)</span>, generally <span class="math inline">\(U_i \neq \hat{U}_i\)</span>.</p>
</div>
<section id="computation-6" class="level3" data-number="5.10.1">
<h3 data-number="5.10.1" class="anchored" data-anchor-id="computation-6"><span class="header-section-number">5.10.1</span> Computation</h3>
<p>Before moving on, let’s just confirm that the formulas that we derived are actually what <code>R</code> uses in order to estimates the parameters in a regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using lm</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>reg8 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data=</span>mtcars)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7121 -2.1122 -0.8854  1.5819  8.2360 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
hp          -0.06823    0.01012  -6.742 1.79e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.863 on 30 degrees of freedom
Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892 
F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using our formulas</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>bet1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(mtcars<span class="sc">$</span>mpg, mtcars<span class="sc">$</span>hp) <span class="sc">/</span> <span class="fu">var</span>(mtcars<span class="sc">$</span>hp)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>bet0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg) <span class="sc">-</span> bet1<span class="sc">*</span><span class="fu">mean</span>(mtcars<span class="sc">$</span>hp)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">bet0=</span>bet0, <span class="at">bet1=</span>bet1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bet0        bet1
1 30.09886 -0.06822828</code></pre>
</div>
</div>
<p>and they are identical.</p>
</section>
<section id="more-than-one-regressor" class="level3" data-number="5.10.2">
<h3 data-number="5.10.2" class="anchored" data-anchor-id="more-than-one-regressor"><span class="header-section-number">5.10.2</span> More than one regressor</h3>
<p>Now, let’s suppose that you want to estimate a more complicated regressions like</p>
<p><span class="math display">\[
  Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3 + U
\]</span></p>
<p>or, even more generally,</p>
<p><span class="math display">\[
  Y = \beta_0 + \beta_1 X_1 + \cdots + \beta_k X_k + U
\]</span> We can still choose the line that best fits the data by solving</p>
<p><span class="math display">\[
  (\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_k) = \underset{b_0,b_1,\ldots,b_k}{\textrm{argmin}} \frac{1}{n} \sum_{i=1}^n (Y_i - b_0 - b_1 X_{1i} - \cdots - b_k X_{ki})^2
\]</span> To do it, we would need to take the derivative with respect to <span class="math inline">\(b_0, b_1, \ldots, b_k\)</span>. This will give a system of equations with <span class="math inline">\((k+1)\)</span> equations and <span class="math inline">\((k+1)\)</span> unknowns. You can solve this — it actually is quite easy / very similar to what we just did if you know just a little bit of linear algebra, but this is beyond the scope of our course — and it is quite easy for the computer to solve.</p>
</section>
</section>
<section id="inference" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="inference"><span class="header-section-number">5.11</span> Inference</h2>
<p>SW 4.5, 5.1, 5.2, 6.6</p>
<p>We discussed in class the practical issues of inference in linear regression models.</p>
<p>These results rely on arguments building on the Central Limit Theorem (this should not surprise you as it is similar to the case for the asymptotic distribution of <span class="math inline">\(\sqrt{n}(\bar{Y} - \E[Y]))\)</span> that we discussed earlier in the semester.</p>
<p>In this section, I sketch these types of arguments for you. This material is advanced, but I suggest that you study this material.</p>
<p>We are going to show that, in the simple linear regression model, <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) \rightarrow N(0,V) \quad \textrm{as} \ n \rightarrow \infty
\end{align*}\]</span> where <span class="math display">\[\begin{align*}
  V = \frac{\E[(X-\E[X])^2 U^2]}{\var(X)^2}
\end{align*}\]</span> and discuss how to use this result to conduct inference.</p>
<p>Let’s start by showing why this result holds.</p>
<p>To start with, recall that <span class="math display">\[\begin{align}
  \hat{\beta}_1 = \frac{\widehat{\cov}(X,Y)}{\widehat{\var}(X)} (\#eq:b1)
\end{align}\]</span></p>
<p>Before providing a main result, let’s start with noting the following:</p>
<p><em>Helpful Intermediate Result 1</em> Notice that <span class="math display">\[\begin{align*}
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})\bar{Y}\Big) &amp;= \bar{Y} \frac{1}{n}\sum_{i=1}^n \Big( X_i-\bar{X} \Big) \\
  &amp;= \bar{Y} \left( \frac{1}{n}\sum_{i=1}^n X_i - \frac{1}{n}\sum_{i=1}^n \bar{X} \right) \\
  &amp;= \bar{Y} \Big(\bar{X} - \bar{X} \Big) \\
  &amp;= 0
\end{align*}\]</span> where the first equality just pulls <span class="math inline">\(\bar{Y}\)</span> out of the summation (it is a constant with respect to the summation), the second equality pushes the summation through the difference, the first part of the third equality holds by the definition of <span class="math inline">\(\bar{X}\)</span> and the second part holds because it is an average of a constant.</p>
<p>This implies that <span class="math display">\[\begin{align}
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})(Y_i - \bar{Y})\Big) = \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})Y_i\Big) (\#eq:hr1)
\end{align}\]</span> and very similar arguments (basically the same arguments in reverse) also imply that <span class="math display">\[\begin{align}
  \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})X_i\Big) = \frac{1}{n}\sum_{i=1}^n \Big( (X_i - \bar{X})(X_i - \bar{X})\Big) (\#eq:hr2)
\end{align}\]</span> We use both @ref(eq:hr1) and @ref(eq:hr2) below.</p>
<p>Next, consider the numerator in @ref(eq:b1) <span class="math display">\[\begin{align*}
  \widehat{\cov}(X,Y) &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y}) \\
  &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})Y_i \\
  &amp;= \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(\beta_0 + \beta_1 X_i + U_i) \\
  &amp;= \underbrace{\beta_0 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})}_{(A)} + \underbrace{\beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) X_i}_{(B)} + \underbrace{\frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) U_i}_{(C)}) \\
\end{align*}\]</span> where the first equality holds by the definition of sample covariance, the second equality holds by @ref(eq:hr1), the third equality plugs in for <span class="math inline">\(Y_i\)</span>, and the last equality combines terms and passes the summation through the additions/subtractions.</p>
<p>Now, let’s consider each of these in turn.</p>
<p>For (A), <span class="math display">\[\begin{align*}
  \frac{1}{n} \sum_{i=1}^n X_i = \bar{X} \qquad \textrm{and} \qquad \frac{1}{n} \sum_{i=1}^n \bar{X} = \bar{X}
\end{align*}\]</span> which implies that this term is equal to 0.</p>
<p>For (B), notice that <span class="math display">\[\begin{align*}
  \beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) X_i &amp;= \beta_1 \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X}) (X_i - \bar{X}) \\
  &amp;= \beta_1 \widehat{\var}(X)
\end{align*}\]</span> where the first equality holds by @ref(eq:hr2) and the second equality holds by the definition of sample variance.</p>
<p>For (C), well, we’ll just carry that one around for now.</p>
<p>Plugging in the expressions for (A), (B), and (C) back into Equation @ref(eq:b1) implies that <span class="math display">\[\begin{align*}
  \hat{\beta}_1 = \beta_1 + \frac{1}{n} \sum_{i=1}^n \frac{(X_i - \bar{X}) U_i}{\widehat{\var}(X)}
\end{align*}\]</span> Next, re-arranging terms and multiplying both sides by <span class="math inline">\(\sqrt{n}\)</span> implies that <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) &amp;= \sqrt{n} \left(\frac{1}{n} \sum_{i=1}^n \frac{(X_i - \bar{X}) U_i}{\widehat{\var}(X)}\right) \\
  &amp; \approx \sqrt{n} \left(\frac{1}{n} \sum_{i=1}^n \frac{(X_i - \E[X]) U_i}{\var(X)}\right)
\end{align*}\]</span> The last line (the approximately one) is kind of a weak argument, but basically you can replace <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\widehat{\var}(X)\)</span> and the effect of this replacement will converge to 0 in large samples (this is the reason for the approximately) — if you want a more complete explanation, sign up for my graduate econometrics class next semester.</p>
<p>Is this helpful? It may not be obvious, but the right hand side of the above equation is actually something that we can apply the Central Limit Theorem to. In particular, maybe it is helpful to define <span class="math inline">\(Z_i = \frac{(X_i - \E[X]) U_i}{\var(X)}\)</span>. We know that we could apply a Central Limit Theorem to <span class="math inline">\(\sqrt{n}\left( \frac{1}{n} \sum_{i=1}^n Z_i \right)\)</span> if (i) <span class="math inline">\(Z_i\)</span> had mean 0, and (ii) it is iid. That it is iid holds immediately from the random sampling assumption. For mean 0, <span class="math display">\[\begin{align*}
  \E[Z] &amp;= \E\left[ \frac{(X - \E[X]) U}{\var(X)}\right] \\
  &amp;= \frac{1}{\var(X)} \E[(X - \E[X]) U] \\
  &amp;= \frac{1}{\var(X)} \E[(X - \E[X]) \underbrace{\E[U|X]}_{=0}] \\
  &amp;= 0
\end{align*}\]</span> where the only challenging line here is the third one holds from the Law of Iterated Expectations. This means that we can apply the central limit theorem, and in particular, <span class="math inline">\(\sqrt{n} \left( \frac{1}{n} \sum_{i=1}^n Z_i \right) \rightarrow N(0,V)\)</span> where <span class="math inline">\(V=\var(Z) = \E[Z^2]\)</span> (where the 2nd equality here holds because <span class="math inline">\(Z\)</span> has mean 0). Now, just substituting back in for <span class="math inline">\(Z\)</span> implies that <span class="math display">\[\begin{align*}
  \sqrt{n}(\hat{\beta}_1 - \beta_1) \rightarrow N(0,V)
\end{align*}\]</span> where <span class="math display">\[\begin{align}
  V &amp;= \E\left[ \left( \frac{(X - \E[X]) U}{\var(X)} \right)^2 \right] \nonumber \\
  &amp;= \E\left[ \frac{(X - \E[X])^2 U^2}{\var(X)^2}\right] (\#eq:V)
\end{align}\]</span> which is what we were aiming for.</p>
<p>Given this result, all our previous work on standard errors, t-statistics, p-values, and confidence intervals applies. First, let me mention the way that you would estimate <span class="math inline">\(V\)</span> (same as always, just replace the population quantities with corresponding sample quantities).</p>
<p><span class="math display">\[
  \hat{V} = \frac{ \frac{1}{n} \displaystyle \sum_{i=1}^n (X_i - \bar{X})^2 \hat{U}_i^2}{\widehat{\Var}(X)^2}
\]</span></p>
<p>where <span class="math inline">\(\hat{U}_i\)</span> are the residuals.</p>
<p>Now, standard errors are just the same as before (the only difference is that <span class="math inline">\(\hat{V}\)</span> itself has changed)</p>
<p><span class="math display">\[
\begin{aligned}
  \textrm{s.e.}(\hat{\beta}) &amp;= \frac{\sqrt{\hat{V}}}{\sqrt{n}}
\end{aligned}
\]</span></p>
<p>By far the most common null hypothesis is <span class="math inline">\(H_0: \beta = 0\)</span>, which suggests the following t-statistic:</p>
<p><span class="math display">\[
  t = \frac{\hat{\beta}}{\textrm{s.e.}(\hat{\beta})}
\]</span> One can continue to calculate a p-value by</p>
<p><span class="math display">\[
  \textrm{p-value} = 2 \Phi(-|t|)
\]</span> and a 95% confidence interval is given by</p>
<p><span class="math display">\[
  CI = [\hat{\beta} - 1.96 \textrm{s.e.}(\hat{\beta}), \hat{\beta} + 1.96 \textrm{s.e.}(\hat{\beta})]
\]</span></p>
<section id="computation-7" class="level3" data-number="5.11.1">
<h3 data-number="5.11.1" class="anchored" data-anchor-id="computation-7"><span class="header-section-number">5.11.1</span> Computation</h3>
<p>Let’s check if what we derived is what we can compute using <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the same regression as in the previous section</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7121 -2.1122 -0.8854  1.5819  8.2360 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
hp          -0.06823    0.01012  -6.742 1.79e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.863 on 30 degrees of freedom
Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892 
F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show previous calcuations</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">bet0=</span>bet0, <span class="at">bet1=</span>bet1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      bet0        bet1
1 30.09886 -0.06822828</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># components of Vhat</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>hp</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>Uhat <span class="ot">&lt;-</span> Y <span class="sc">-</span> bet0 <span class="sc">-</span> bet1<span class="sc">*</span>X</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>Xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>varX <span class="ot">&lt;-</span> <span class="fu">mean</span>( (X<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>Vhat <span class="ot">&lt;-</span> <span class="fu">mean</span>( (X<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> Uhat<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">/</span> ( varX<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mtcars)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Vhat)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> bet1<span class="sc">/</span>se</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(t_stat))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>ci_L <span class="ot">&lt;-</span> bet1 <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>ci_U <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(se, t_stat, p_val, ci_L, ci_U),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       se   t_stat p_val     ci_L     ci_U
1 0.01313 -5.19644     0 -0.09396 -0.04249</code></pre>
</div>
</div>
<p>Interestingly, these are not <em>exactly</em> the same as what comes from the <code>lm</code> command. Here’s what the difference is: <code>R</code> makes a simplifying assumption called “homoskedasticity” that simplifies the expression for the variance. This can result in slightly different standard errors (and therefore slightly different t-statistics, p-values, and confidence intervals too) than the ones we calculated.</p>
<p>An alternative package that is popular among economists for estimating regressions and getting “heteroskedasticity robust” standard errors is the <code>estimatr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>reg9 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(mpg <span class="sc">~</span> hp, <span class="at">data=</span>mtcars, <span class="at">se_type=</span><span class="st">"HC0"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm_robust(formula = mpg ~ hp, data = mtcars, se_type = "HC0")

Standard error type:  HC0 

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
(Intercept) 30.09886    2.01067  14.970 1.851e-15 25.99252 34.20520 30
hp          -0.06823    0.01313  -5.196 1.338e-05 -0.09504 -0.04141 30

Multiple R-squared:  0.6024 ,   Adjusted R-squared:  0.5892 
F-statistic:    27 on 1 and 30 DF,  p-value: 1.338e-05</code></pre>
</div>
</div>
<p>The “HC0” standard errors are “heteroskedasticity consistent” standard errors, and you can see that they match what we calculated above.</p>
</section>
</section>
<section id="lab-4-birthweight-and-smoking" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="lab-4-birthweight-and-smoking"><span class="header-section-number">5.12</span> Lab 4: Birthweight and Smoking</h2>
<p>For this lab, we’ll use the data <code>Birthweight_Smoking</code> and study the relationship between infant birthweight and mother’s smoking behavior.</p>
<ol type="1">
<li><p>Run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>. How do you interpret the results?</p></li>
<li><p>Use the <code>datasummary_balance</code> function from the <code>modelsummary</code> package to provide summary statistics for each variable in the data separately by smoking status of the mother. Do you notice any interesting patterns?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, <span class="math inline">\(educ\)</span>, <span class="math inline">\(nprevisit\)</span>, <span class="math inline">\(age\)</span>, and <span class="math inline">\(alcohol\)</span>. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span>? How does its magnitude compare to the result from #1? What do you make of this?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, the interaction of <span class="math inline">\(smoker\)</span> and <span class="math inline">\(age\)</span> and the other covariates (including <span class="math inline">\(age\)</span>) from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span> and the coefficient on the interaction term?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(smoker\)</span>, the interaction of <span class="math inline">\(smoker\)</span> and <span class="math inline">\(alcohol\)</span> and the other covariates from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span> and the coefficient on the interaction term?</p></li>
<li><p>Now run a regression of <span class="math inline">\(birthweight\)</span> on <span class="math inline">\(age\)</span> and <span class="math inline">\(age^2\)</span>. Plot the predicted value of birthweight as a function of age for ages from 18 to 44. What do you make of this?</p></li>
<li><p>Now run a regression of <span class="math inline">\(\log(birthweight)\)</span> on <span class="math inline">\(smoker\)</span> and the other covariates from #3. How do you interpret the coefficient on <span class="math inline">\(smoker\)</span>?</p></li>
</ol>
</section>
<section id="lab-4-solutions" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="lab-4-solutions"><span class="header-section-number">5.13</span> Lab 4: Solutions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>Birthweight_Smoking <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data/birthweight_smoking.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker, <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-3007.06  -313.06    26.94   366.94  2322.94 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3432.06      11.87 289.115   &lt;2e-16 ***
smoker       -253.23      26.95  -9.396   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 583.7 on 2998 degrees of freedom
Multiple R-squared:  0.0286,    Adjusted R-squared:  0.02828 
F-statistic: 88.28 on 1 and 2998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We estimate that, on average, smoking reduces an infant’s birthweight by about 250 grams. The estimated effect is strongly statistically significant, and (I am not an expert but) that seems like a large effect of smoking to me.</p>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create smoker factor --- just to make table look nicer</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Birthweight_Smoking<span class="sc">$</span>smoker_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(Birthweight_Smoking<span class="sc">$</span>smoker<span class="sc">==</span><span class="dv">1</span>, <span class="st">"smoker"</span>, <span class="st">"non-smoker"</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_balance</span>(<span class="sc">~</span>smoker_factor, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>dplyr<span class="sc">::</span><span class="fu">select</span>(Birthweight_Smoking, <span class="sc">-</span>smoker),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fmt=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_fnkosp6v5wc9nj5xsmen</title>
    <style>
.table td.tinytable_css_0wj5ukr8wy5uhoklgh1w, .table th.tinytable_css_0wj5ukr8wy5uhoklgh1w {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_kat6mjavdlqv6d66c60t, .table th.tinytable_css_kat6mjavdlqv6d66c60t {    text-align: center; }
.table td.tinytable_css_yeirwnepfx0dberxdwq7, .table th.tinytable_css_yeirwnepfx0dberxdwq7 {    border-bottom: solid 0.05em #d3d8dc; }
.table td.tinytable_css_mr41pmzkrskbzq2wwfay, .table th.tinytable_css_mr41pmzkrskbzq2wwfay {    text-align: left; }
.table td.tinytable_css_glwjfsvv4um6wxtbb6ls, .table th.tinytable_css_glwjfsvv4um6wxtbb6ls {    text-align: right; }
.table td.tinytable_css_7qilal07vhifv3twpcex, .table th.tinytable_css_7qilal07vhifv3twpcex {    text-align: right; }
.table td.tinytable_css_ckvnpaim2gd9ea2wt06b, .table th.tinytable_css_ckvnpaim2gd9ea2wt06b {    text-align: right; }
.table td.tinytable_css_ir7ilipqq9lab0pvr2w1, .table th.tinytable_css_ir7ilipqq9lab0pvr2w1 {    text-align: right; }
.table td.tinytable_css_fwnqznx6ifd2332rx8oo, .table th.tinytable_css_fwnqznx6ifd2332rx8oo {    text-align: right; }
.table td.tinytable_css_h2qomll05al1uxnu6wyr, .table th.tinytable_css_h2qomll05al1uxnu6wyr {    text-align: right; }
.table td.tinytable_css_nt4mmhwnpgu4lsyopf3r, .table th.tinytable_css_nt4mmhwnpgu4lsyopf3r {    text-align: center; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_fnkosp6v5wc9nj5xsmen" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">non-smoker (N=2418)</th>
<th scope="col" align="center" colspan="2">smoker (N=582)</th>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="1"> </th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
                <th scope="col">Diff. in Means</th>
                <th scope="col">Std. Error</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>nprevist   </td>
                  <td>11.19  </td>
                  <td>3.50  </td>
                  <td>10.18  </td>
                  <td>4.23  </td>
                  <td>-1.01  </td>
                  <td>0.19 </td>
                </tr>
                <tr>
                  <td>alcohol    </td>
                  <td>0.01   </td>
                  <td>0.11  </td>
                  <td>0.05   </td>
                  <td>0.22  </td>
                  <td>0.04   </td>
                  <td>0.01 </td>
                </tr>
                <tr>
                  <td>tripre1    </td>
                  <td>0.83   </td>
                  <td>0.38  </td>
                  <td>0.70   </td>
                  <td>0.46  </td>
                  <td>-0.13  </td>
                  <td>0.02 </td>
                </tr>
                <tr>
                  <td>tripre2    </td>
                  <td>0.14   </td>
                  <td>0.34  </td>
                  <td>0.22   </td>
                  <td>0.41  </td>
                  <td>0.08   </td>
                  <td>0.02 </td>
                </tr>
                <tr>
                  <td>tripre3    </td>
                  <td>0.03   </td>
                  <td>0.16  </td>
                  <td>0.06   </td>
                  <td>0.24  </td>
                  <td>0.04   </td>
                  <td>0.01 </td>
                </tr>
                <tr>
                  <td>tripre0    </td>
                  <td>0.01   </td>
                  <td>0.08  </td>
                  <td>0.02   </td>
                  <td>0.15  </td>
                  <td>0.02   </td>
                  <td>0.01 </td>
                </tr>
                <tr>
                  <td>birthweight</td>
                  <td>3432.06</td>
                  <td>584.62</td>
                  <td>3178.83</td>
                  <td>580.01</td>
                  <td>-253.23</td>
                  <td>26.82</td>
                </tr>
                <tr>
                  <td>unmarried  </td>
                  <td>0.18   </td>
                  <td>0.38  </td>
                  <td>0.43   </td>
                  <td>0.50  </td>
                  <td>0.25   </td>
                  <td>0.02 </td>
                </tr>
                <tr>
                  <td>educ       </td>
                  <td>13.15  </td>
                  <td>2.21  </td>
                  <td>11.88  </td>
                  <td>1.62  </td>
                  <td>-1.27  </td>
                  <td>0.08 </td>
                </tr>
                <tr>
                  <td>age        </td>
                  <td>27.27  </td>
                  <td>5.37  </td>
                  <td>25.32  </td>
                  <td>5.06  </td>
                  <td>-1.95  </td>
                  <td>0.24 </td>
                </tr>
                <tr>
                  <td>drinks     </td>
                  <td>0.03   </td>
                  <td>0.47  </td>
                  <td>0.19   </td>
                  <td>1.23  </td>
                  <td>0.16   </td>
                  <td>0.05 </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_a2u9hp23ukxerintmqtb(i, j, css_id) {
        var table = document.getElementById("tinytable_fnkosp6v5wc9nj5xsmen");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_fnkosp6v5wc9nj5xsmen');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_a2u9hp23ukxerintmqtb(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_fnkosp6v5wc9nj5xsmen");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 0, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 1, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 2, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 3, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 4, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 5, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 6, 'tinytable_css_0wj5ukr8wy5uhoklgh1w') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 0, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 1, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 2, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 3, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 4, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 5, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 6, 'tinytable_css_kat6mjavdlqv6d66c60t') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 1, 'tinytable_css_yeirwnepfx0dberxdwq7') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 2, 'tinytable_css_yeirwnepfx0dberxdwq7') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 0, 'tinytable_css_mr41pmzkrskbzq2wwfay') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 1, 'tinytable_css_glwjfsvv4um6wxtbb6ls') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 2, 'tinytable_css_7qilal07vhifv3twpcex') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 3, 'tinytable_css_ckvnpaim2gd9ea2wt06b') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 4, 'tinytable_css_ir7ilipqq9lab0pvr2w1') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 5, 'tinytable_css_fwnqznx6ifd2332rx8oo') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(1, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(2, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(3, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(4, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(5, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(6, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(7, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(8, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(9, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(10, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(11, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(12, 6, 'tinytable_css_h2qomll05al1uxnu6wyr') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 0, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 1, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 2, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 3, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 4, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 5, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
window.addEventListener('load', function () { styleCell_tinytable_a2u9hp23ukxerintmqtb(0, 6, 'tinytable_css_nt4mmhwnpgu4lsyopf3r') })
    </script>

  


</div>
</div>
<p>The things that stand out to me are:</p>
<ul>
<li><p>Birthweight tends to be notably lower for smokers relative to non-smokers. The difference is about 7.4% lower birthweight for babies whose mothers smoked.</p></li>
<li><p>That said, smoking is also correlated with a number of other things that could be related to lower birthweights. Mothers who smoke went to fewer pre-natal visits on average, were more likely to be unmarried, were more likely to have drink alcohol during their pregnancy, were more likely to be less educated. They also were, on average, somewhat younger than mothers who did not smoke.</p></li>
</ul>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + educ + nprevist + age + alcohol, 
    data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2728.91  -305.26    24.69   359.63  2220.42 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2924.963     74.185  39.428  &lt; 2e-16 ***
smoker      -206.507     27.367  -7.546 5.93e-14 ***
educ           5.644      5.532   1.020    0.308    
nprevist      32.979      2.914  11.318  &lt; 2e-16 ***
age            2.360      2.178   1.083    0.279    
alcohol      -39.512     76.365  -0.517    0.605    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 570.3 on 2994 degrees of freedom
Multiple R-squared:  0.07402,   Adjusted R-squared:  0.07247 
F-statistic: 47.86 on 5 and 2994 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here we estimate that smoking reduces an infant’s birthweight by about 200 grams on average holding education, number of pre-natal visits, age, and whether or not the mother consumed alcohol constant. The magnitude of the estimated effect is somewhat smaller than the previous estimate. Due to the discussion in #2 (particularly, that smoking was correlated with a number of other characteristics that are likely associated with lower birthweights), this decrease in the magnitude is not surprising.</p>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> <span class="fu">I</span>(smoker<span class="sc">*</span>age) <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + I(smoker * age) + educ + 
    nprevist + age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2722.56  -305.12    23.93   363.43  2244.67 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     2853.819     77.104  37.013  &lt; 2e-16 ***
smoker           231.578    134.854   1.717 0.086036 .  
I(smoker * age)  -17.145      5.168  -3.317 0.000919 ***
educ               4.895      5.528   0.885 0.375968    
nprevist          32.482      2.913  11.151  &lt; 2e-16 ***
age                5.528      2.375   2.328 0.019999 *  
alcohol          -22.556     76.409  -0.295 0.767864    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 569.4 on 2993 degrees of freedom
Multiple R-squared:  0.07741,   Adjusted R-squared:  0.07556 
F-statistic: 41.85 on 6 and 2993 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We should be careful about the interpretatio here. We have estimated a model like</p>
<p><span class="math display">\[
  \E[Birthweight|Smoker, Age, X] = \beta_0 + \beta_1 Smoker + \beta_2 Smoker \cdot Age + \cdots
\]</span> Therefore, the partial effect of smoking is given by</p>
<p><span class="math display">\[
  \E[Birthweight | Smoker=1, Age, X] - \E[Birthweight | Smoker=0, Age, X] = \beta_1 + \beta_2 Age
\]</span> Therefore, the partial effect of smoking depends on <span class="math inline">\(Age\)</span>. For example, for <span class="math inline">\(Age=18\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (18)\)</span>. For <span class="math inline">\(Age=25\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (25)\)</span>, and for <span class="math inline">\(Age=35\)</span>, the partial effect is <span class="math inline">\(\beta_1 + \beta_2 (35)\)</span>. Let’s calculate the partial effect at each of those ages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>bet1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg4)[<span class="dv">2</span>]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>bet2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg4)[<span class="dv">3</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>pe_18 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">18</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>pe_25 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">25</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>pe_35 <span class="ot">&lt;-</span> bet1 <span class="sc">+</span> bet2<span class="sc">*</span><span class="dv">35</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind.data.frame</span>(pe_18, pe_25, pe_35),<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        pe_18   pe_25   pe_35
smoker -77.04 -197.05 -368.51</code></pre>
</div>
</div>
<p>This suggests substantially larger effects of smoking on birthweight for older mothers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>reg5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> smoker <span class="sc">+</span> <span class="fu">I</span>(smoker<span class="sc">*</span>alcohol) <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ smoker + I(smoker * alcohol) + educ + 
    nprevist + age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2728.99  -304.16    24.54   359.92  2222.10 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         2924.844     74.185  39.426  &lt; 2e-16 ***
smoker              -201.852     27.765  -7.270 4.57e-13 ***
I(smoker * alcohol) -151.860    152.717  -0.994    0.320    
educ                   5.612      5.532   1.014    0.310    
nprevist              32.844      2.917  11.260  &lt; 2e-16 ***
age                    2.403      2.178   1.103    0.270    
alcohol               39.824    110.440   0.361    0.718    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 570.3 on 2993 degrees of freedom
Multiple R-squared:  0.07432,   Adjusted R-squared:  0.07247 
F-statistic: 40.05 on 6 and 2993 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The point estimate suggests that the effect of smoking is larger for women who consume alcohol and smoke than for women who do not drink alcohol. This seems plausible, but our evidence is not very strong here — the estimates are not statistically significant at any conventional significance level (the p-value is equal to 0.32).</p>
<ol start="6" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>reg6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birthweight <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = birthweight ~ age + I(age^2), data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-2949.81  -312.81    30.43   371.03  2452.72 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2502.8949   225.6016  11.094  &lt; 2e-16 ***
age           58.1670    16.9212   3.438 0.000595 ***
I(age^2)      -0.9099     0.3099  -2.936 0.003353 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 589.6 on 2997 degrees of freedom
Multiple R-squared:  0.009261,  Adjusted R-squared:  0.0086 
F-statistic: 14.01 on 2 and 2997 DF,  p-value: 8.813e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg6, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>,<span class="dv">40</span>)))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">preds=</span>preds, <span class="at">age=</span><span class="fu">seq</span>(<span class="dv">18</span>,<span class="dv">40</span>)), <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>preds)) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"predicted values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-linear_regression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The figure suggests that predicted birthweight is increasing in mother’s age up until about age 34 and then decreasing after that.</p>
<ol start="7" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>reg7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(<span class="fu">log</span>(birthweight)) <span class="sc">~</span> smoker <span class="sc">+</span> educ <span class="sc">+</span> nprevist <span class="sc">+</span> age <span class="sc">+</span> alcohol,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>Birthweight_Smoking)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = I(log(birthweight)) ~ smoker + educ + nprevist + 
    age + alcohol, data = Birthweight_Smoking)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.96324 -0.07696  0.02435  0.12092  0.50070 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.9402678  0.0270480 293.562  &lt; 2e-16 ***
smoker      -0.0635764  0.0099782  -6.372 2.16e-10 ***
educ         0.0022169  0.0020171   1.099    0.272    
nprevist     0.0129662  0.0010624  12.205  &lt; 2e-16 ***
age          0.0003059  0.0007941   0.385    0.700    
alcohol     -0.0181053  0.0278428  -0.650    0.516    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2079 on 2994 degrees of freedom
Multiple R-squared:  0.07322,   Adjusted R-squared:  0.07167 
F-statistic: 47.31 on 5 and 2994 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The estimated coefficient on <span class="math inline">\(smoker\)</span> says that smoking during pregnancy decreases a baby’s birthweight by 6.3%, on average, holding education, number of pre-natal visits, age of the mother, and whether or not the mother consumed alcohol during the pregnancy constant.</p>
</section>
<section id="coding-questions" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="coding-questions"><span class="header-section-number">5.14</span> Coding Questions</h2>
<ol type="1">
<li><p>For this problem, we will use the data <code>Caschool</code>. This data contains information about test scores for schools from California from the 1998-1999 academic year. For this problem, we will use the variables <code>testscr</code> (average test score in the school), <code>str</code> (student teacher ratio in the school), <code>avginc</code> (the average income in the school district), and <code>elpct</code> (the percent of English learners in the school).</p>
<ol type="a">
<li><p>Run a regression of test scores on student teacher ratio, average income, and English learners percentage. Report your results. Which regressors are statistically significant? How do you know?</p></li>
<li><p>What is the average test score across all schools in the data?</p></li>
<li><p>What is the predicted average test score for a school with a student teacher ratio of 20, average income of $30,000, and 10% English learners? How does this compare to the overall average test score from part (b)?</p></li>
<li><p>What is the predicted average test score for a school with a student teacher ratio of 15, average income of $30,000, and 10% English learners? How does this compare to your answer from part (c)?</p></li>
</ol></li>
<li><p>For this problem, we will use the data <code>intergenerational_mobility</code>.</p>
<ol type="a">
<li><p>Run a regression of child family income (<span class="math inline">\(child\_fincome\)</span>) on parents’ family income (<span class="math inline">\(parent\_fincome\)</span>). How should you interpret the estimated coefficient on parents’ family income? What is the p-value for the coefficient on parents’ family income?</p></li>
<li><p>Run a regression of <span class="math inline">\(\log(child\_fincome)\)</span> on <span class="math inline">\(parent\_fincome\)</span>. How should you interpret the estimated cofficient on <span class="math inline">\(parent\_fincome\)</span>?</p></li>
<li><p>Run a regression of <span class="math inline">\(child\_fincome\)</span> on <span class="math inline">\(\log(parent\_fincome)\)</span>. How should you interpret the estimated coefficient on <span class="math inline">\(\log(parent\_fincome)\)</span>?</p></li>
<li><p>Run a regression of <span class="math inline">\(\log(child\_fincome)\)</span> on <span class="math inline">\(\log(parent\_fincome)\)</span>. How should you interpret the estimated coefficient on <span class="math inline">\(\log(parent\_fincome)\)</span>?</p></li>
</ol></li>
<li><p>For this question, we’ll use the <code>fertilizer_2000</code> data.</p>
<ol type="a">
<li><p>Run a regression of <span class="math inline">\(\log(avyield)\)</span> on <span class="math inline">\(\log(avfert)\)</span>. How do you interpret the estimated coefficient on <span class="math inline">\(\log(avfert)\)</span>?</p></li>
<li><p>Now suppose that you additionally want to control for precipitation and the region that a country is located in. How would you do this? Estimate the model that you propose here, report the results, and interpret the coefficient on <span class="math inline">\(\log(avfert)\)</span>.</p></li>
<li><p>Now suppose that you are interested in whether the effect of fertilizer varies by region that a country is located in (while still controlling for the same covariates as in part (b)). Propose a model that can be used for this purpose. Estimate the model that you proposed, report the results, and discuss whether the effect of fertilizer appears to vary by region or not.</p></li>
</ol></li>
<li><p>For this question, we will use the data <code>mutual_funds</code>. We’ll be interested in whether mutual funds that have higher expense ratios (these are typically actively managed funds) have higher returns relative to mutual funds that have lower expense ratios (e.g., index funds). For this problem, we will use the variables <code>fund_return_3years</code>, <code>investment_type</code>, <code>risk_rating</code>, <code>size_type</code>, <code>fund_net_annual_expense_ratio</code>, <code>asset_cash</code>, <code>asset_stocks</code>, <code>asset_bonds</code>.</p>
<ol type="a">
<li><p>Calculate the median <code>fund_net_annual_expense_ratio</code>.</p></li>
<li><p>Use the <code>datasummary_balance</code> function from the <code>modelsummary</code> package to report summary statistics for <code>fund_return_3year</code>, <code>fund_net_annual_expense_ratio</code>, <code>risk_rating</code>, <code>asset_cash</code>, <code>asset_stocks</code>, <code>asset_bonds</code> based on whether their expense ratio is above or below the median. Do you notice any interesting patterns?</p></li>
<li><p>Run a regression of <code>fund_return_3years</code> on <code>fund_net_annual_expense_ratio</code>. How do you interpret the results?</p></li>
<li><p>Now, additionally control for <code>investment_type</code>, <code>risk_rating</code>, and <code>size_type</code> <strong>Hint:</strong> think carefully about what type of variables each of these are and how they should enter the model. How do these results compare to the ones from part c?</p></li>
<li><p>Now, add the variables <code>assets_cash</code>, <code>assets_stocks</code>, and <code>assets_bonds</code> to the model from part d.&nbsp;How do you interpret these results? Compare and interpret the differences between parts c, d, and e.</p></li>
</ol></li>
<li><p>For this question, we’ll use the data <code>Lead_Mortality</code> to study the effect of lead pipes on infant mortality in 1900.</p>
<ol type="a">
<li><p>Run a regression of infant mortality (<code>infrate</code>) on whether or not a city had lead pipes (<code>lead</code>) and interpret/discuss the results.</p></li>
<li><p>It turns out that the amount of lead in drinking water depends on how acidic the water is, with more acidic water leaching more of the lead (so that there is more exposure to lead with more acidic water). To measure acidity, we’ll use the pH of the water in a particular city (<code>ph</code>); recall that, a lower value of pH indicates higher acidity. Run a regression of infant mortality on whether or not a city has lead pipes, the pH of its water, and the interaction between having lead pipes and pH. Report your results. What is the estimated partial effect of having lead pipes from this model?</p></li>
<li><p>Given the results in part b, calculate an estimate of the average partial effect of having lead pipes on infant mortality.</p></li>
<li><p>Given the results in part b, how much does the partial effect of having lead pipes differ for cities that have a pH of 6.5 relative to a pH of 7.5?</p></li>
</ol></li>
</ol>
</section>
<section id="extra-questions" class="level2" data-number="5.15">
<h2 data-number="5.15" class="anchored" data-anchor-id="extra-questions"><span class="header-section-number">5.15</span> Extra Questions</h2>
<ol type="1">
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  Earnings = \beta_0 + \beta_1 Education + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  Earnings = \beta_0 + \beta_1 Education + \beta_2 Experience + \beta_3 Female + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education, Experience, Female] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>Suppose you are interested in testing whether an extra year of education increases earnings by the same amount for men and women.</p>
<ol type="a">
<li><p>Propose a regression and strategy for this sort of test.</p></li>
<li><p>Suppose you also want to control for experience in conducting this test, how would do it?</p></li>
</ol></li>
<li><p>Suppose you run the following regression <span class="math display">\[\begin{align*}
  \log(Earnings) = \beta_0 + \beta_1 Education + \beta_2 Experience + \beta_3 Female + U
\end{align*}\]</span> with <span class="math inline">\(\E[U|Education, Experience, Female] = 0\)</span>. How do you interpret <span class="math inline">\(\beta_1\)</span> here?</p></li>
<li><p>A common extra condition (though somewhat old-fashioned) is to impose <em>homoskedasticity</em>. Homoskedasticity says that <span class="math inline">\(\E[U^2|X] = \sigma^2\)</span> (i.e., the variance of the error term does not change across different values of <span class="math inline">\(X\)</span>).</p>
<ol type="a">
<li><p>Under homoskedasticity, the expression for <span class="math inline">\(V\)</span> in @ref(eq:V) simplifies. Provide a new expression for <span class="math inline">\(V\)</span> under homoskedasticity. <strong>Hint:</strong> you will need to use the law of iterated expectations.</p></li>
<li><p>Using this expression for <span class="math inline">\(V\)</span>, explain how to calculate standard errors for an estimate of <span class="math inline">\(\beta_1\)</span> in a simple linear regression.</p></li>
<li><p>Explain how to construct a t-statistic for testing <span class="math inline">\(H_0: \beta_1=0\)</span> under homoskedasticity.</p></li>
<li><p>Explain how to contruct a p-value for <span class="math inline">\(\beta_1\)</span> under homoskedasticity.</p></li>
<li><p>Explain how to construct a 95% confidence interval for <span class="math inline">\(\beta_1\)</span> under homoskedasticity.</p></li>
</ol></li>
</ol>
</section>
<section id="answers-to-some-extra-questions" class="level2" data-number="5.16">
<h2 data-number="5.16" class="anchored" data-anchor-id="answers-to-some-extra-questions"><span class="header-section-number">5.16</span> Answers to Some Extra Questions</h2>
<p><strong>Answer to Question 2</strong></p>
<p><span class="math inline">\(\beta_1\)</span> is how much <span class="math inline">\(Earnings\)</span> increase on average when <span class="math inline">\(Education\)</span> increases by one year holding <span class="math inline">\(Experience\)</span> and <span class="math inline">\(Female\)</span> constant.</p>
<p><strong>Answer to Question 3</strong></p>
<ol type="a">
<li><p>Run the regression <span class="math display">\[\begin{align*}
     Earnings &amp;= \beta_0 + \beta_1 Education + \beta_2 Female + \beta_3 Education \times Female + U
\end{align*}\]</span> and test (e.g., calculate a t-statistic and check if it is greater than 1.96 in absolute value) if <span class="math inline">\(\beta_3=0\)</span>.</p></li>
<li><p>You can run the following regression: <span class="math display">\[\begin{align*}
   Earnings &amp;= \beta_0 + \beta_1 Education + \beta_2 Female \\
   &amp; \hspace{25pt} + \beta_3 Education \times Female + \beta_4 Experience + U
\end{align*}\]</span> Here, you would still be interested in <span class="math inline">\(\beta_3\)</span>. If you thought that the return to experience varied for men and women, you might also include an interaction term involving <span class="math inline">\(Experience\)</span> and <span class="math inline">\(Female\)</span>.</p></li>
</ol>
<p><strong>Partial Answer to Question 5</strong></p>
<ol type="a">
<li>Starting from @ref(eq:V)</li>
</ol>
<p><span class="math display">\[\begin{align*}
    V &amp;= \E\left[ \frac{(X - \E[X])^2 U^2}{\var(X)^2} \right] \\
    &amp;= \frac{1}{\var(X)^2} \E[(X-\E[X])^2 U^2] \\
    &amp;= \frac{1}{\var(X)^2} \E\big[(X-\E[X])^2 \E[U^2|X] \big] \\
    &amp;= \frac{1}{\var(X)^2} \E[(X-\E[X])^2 \sigma^2 ] \\
    &amp;= \frac{\sigma^2}{\var(X)^2} \E[(X-\E[X])^2] \\
    &amp;= \frac{\sigma^2}{\var(X)^2} \var(X) \\
    &amp;= \frac{\sigma^2}{\var(X)}
  \end{align*}\]</span></p>
<p>where</p>
<ul>
<li><p>the second equality holds because <span class="math inline">\(\var(X)^2\)</span> is non-random and can come out of the expectation,</p></li>
<li><p>the third equality uses the law of iterated expectations,</p></li>
<li><p>the fourth equality holds by the condition of homoskedasticity,</p></li>
<li><p>the fifth equality holds because <span class="math inline">\(\sigma^2\)</span> is non-random and can come out of the expectation,</p></li>
<li><p>the sixth equality holds by the definition of variance, and</p></li>
<li><p>the last equality holds by canceling <span class="math inline">\(\var(X)\)</span> in the numerator with one of the <span class="math inline">\(\var(X)\)</span>’s in the denominator.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-estimators.html" class="pagination-link" aria-label="Properties of Estimators">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Properties of Estimators</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-prediction.html" class="pagination-link" aria-label="Prediction">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>